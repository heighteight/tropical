%
\begin{remark}\label{rem:functor}
Given $f:X\to Q$, $f$ is a functor precisely when for all $x,y\in X$ $f(x)\leq\inf_{x'\in X}f(x')+X(x',x)$. 
Indeed, if $f$ is a functor then $f(x)\leq f(x')+X(x',x)$, since $f(x)-f(x')=Q(f(x'),f(x))\leq X(x',x)$. 
Conversely, if $f(x)\leq f(x')+X(x',x)$ holds for all $x'$, then 
$Q(f(x),f(x'))=f(x')-f(x)\leq X(x',x)$. 
\end{remark}



\begin{remark}[Yoneda embedding]
%$\Lawv$ is a $\Lawv$-category with $Q(x,y)=|x-y|$. 
%For any $\Lawv$-category $X$ we can define a new $\Lawv$-category $\mathsf{Dist}(X,Q)$ (that we note simply as $[X,Q]$) whose objects are the distributors $x:\{\star\}\pfun X$, or equivalently, the functors from $X$ to $\Lawv$, i.e.~those $x\in \Lawv^{X}$ such that $|x_{a}-x_{b}|\leq X(a,b)$, or equivalently $x_{a}+X(a,b) \geq x_{b}$.


The \emph{Yoneda embedding} is the faithful functor $\B Y: X\to [X,Q]$ given by $\B Y(x)(y)=X(y,x)$. The functoriality and faithfulness of $\B Y$ follow from
\begin{align}
[X,Q](\B Y(x),\B Y(x'))= X(x,x') \tag{Yoneda}
\end{align}
which is proved as follows: for all $y\in X$ we have 
\begin{align*}
Q( \B Y(x)(y),\B Y(x')(y))&= \B Y(x')(y)-\B Y(x)(y) \\
&= X(y,x')-X(y,x) \leq X(x,x')
\end{align*}
where the last step follows from $X(y,x)+X(x,x')\geq X(y,x')$. 
From this we deduce that $[X,Q](\B Y(x),\B Y(x'))=\sup_{y\in X}Q( \B Y(x)(y),\B Y(x')(y))\leq X(x,x')$. 
For the converse direction, we have  
\begin{align*}
X(x,x') &  = X(x,x') - 0 \\ &=
X(x,x')- X(x,x)
\\& =\B Y(x')(x)-\B Y(x)(x)= Q(\B Y(x)(x),\B Y(x')(x))\\
&\leq [X,Q](\B Y(x), \B Y(x'))
\end{align*}
\end{remark}


\begin{remark}
The \emph{opposite Yoneda embedding} is the faithful functor
$\B Y^{\mathrm{op}}: X\to [X,Q]^{\mathrm{op}}$ given by $\B Y^{\mathrm{op}}(x)(y)=X(x,y)$. The functoriality and faithfulness of $\B Y^{\mathrm{op}}$ follow from
\begin{align}\label{eq:yonedaop}
[X,Q](\B Y^{\mathrm{op}}(x),\B Y^{\mathrm{op}}(x'))= X(x',x) \tag{Yoneda$^{\mathrm{op}}$}
\end{align}
which is proved similarly to the case of $\B Y$.
\end{remark}

\subsubsection{completeness}






Composition with $r:X\pfun Y$ yields a functor
$$
r\cdot \_ : \LREL(A,X)   \longrightarrow \LREL(A,Y)
$$
which
has a right-adjoint
$$
\_ \multimapinv r : \LREL(A,Y)   \longrightarrow \LREL(A,X)
$$
given, for $s:A\pfun Y$ by 
\begin{align*}
(s\multimapinv r)(a,x)= \sup_{y\in Y}s(a,y) \dotdiv r(x,y)
%(R\multimap S)(a,x)= \sup_{y\in Y}
\end{align*}




%
%
%Let $\Phi:Y\pfun Z$ be a distributor and $f:Y\to X$ be a functor.
%A functor $ g:Z\to X$ is called the \emph{$\Phi$-weighted colimit of $f$} if it satisfies, for all
%$z\in Z$ and 
% $x\in X$, 
%$$
%X(g(z), x) \ = \  \sup_{y\in Y}X(f(y),x) - \Phi(y,z)
%$$
%If this colimit exists, we write it as $\mathrm{colim}(\Phi,f)$.
%
%
%A $\Lawv$-category $X$ is said \emph{complete} if it admits all weighted colimits, and a functor $f:X\to Y$ of $\Lawv$-categories is said \emph{continuous} if it commutes with all weighted colimits, meaning that $f \circ \mathrm{colim}(\Phi,g)= \mathrm{colim}(\Phi, f\circ g)$.
%
%
%
%We let $\GMet$ indicate the category of skeletal and complete $\Lawv$-categories and continuous functors. 
%
%

For a $\Lawv$-category $X$, we write $x\simeq y$ when $X(x,y)=X(y,x)=0$. $\simeq$ coincides with $=$ precisely when $x$ is skeletal.

\begin{proposition}\label{prop:yonedasup}
Let $X$ be a skeletal $\Lawv$-category. Then $X$ is complete iff the Yoneda embedding has a left-adjoint.
\end{proposition}
\begin{proof}
 For all $ x\in [X,Q]$, let $\sup x$ be defined as a weighted colimit via
$$
X(\sup x, b)= \sup_{a\in X} X(a,b)-x_{a}
$$
that is, $\sup  x= \mathrm{colim}(  x, \mathrm{id}_{X})$, where $ x$ is seen as a distributor $x:\{\star\}\pfun X$.


Let us check that $\sup: [X,Q]\to X$ is a functor. First, let us check the  inequality
\begin{align}\label{eq:in1}
(X\multimapinv y)\cdot ( y\multimapinv x)\geq (X\multimapinv x)\end{align}
as follows:
\begin{align*}
\left((X\multimapinv  y)\cdot ( y\multimapinv x)\right)(a)&=
 \left (\sup_{b}X(b,a)- y_{b}\right)+\left(\sup_{b} y_{b}-x_{b}\right)\\
&\geq
\sup_{b}(X(b,a)- y_{b})+( y_{b}-x_{b})
\\
&=\sup_{b}(X(b,a)- y_{b}+ y_{b})-x_{b}
\\
&=\sup_{b} X(b,a)-x_{a}\\
&= (X\multimapinv x)(a)
\end{align*}
From \eqref{eq:in1} we deduce immediately the inequality below:
\begin{align}\label{eq:in2}
 y\multimapinv x \geq (X\multimapinv x)\multimapinv(X\multimapinv y)
\end{align}
and we can now compute:
\begin{align*}
[X,Q](x,  y)&= \sup_{a\in X} y_{a}-x_{a}\\
 &\stackrel{\tiny\eqref{eq:in2}}{\geq}
 \sup_{a\in X} \left( \sup_{b\in X}X(b,a)-x_{a}\right) -\left(  \sup_{b\in X}X(b,a)- y_{a}   \right )\\
 &= \sup_{a\in X}X(\sup x, a)-X(\sup  y, a)\\
 &= [X,Q](\B Y^{\mathrm{op}}(\sup y),\B Y^{\mathrm{op}}(\sup x))
 \tag{\ref{eq:yonedaop}}
 \\
&=X(\sup x, \sup  y)
\end{align*}


Then for all $x\in X$, $\sup \B Y(x)\simeq x$. Indeed we have 
\begin{align*}
X(\sup \B Y(x), y) & = \sup_{z\in X}X(z,y) -\B Y(x)(z) \\
& = \sup_{z\in X}X(z,y)-X(z,x)\\
&= X(x,y)
\end{align*}
%where we use the fact that from $X(x,y)+X(z,x) \geq X(z,y)$ it follows $X(x,y) \geq X(z,y)-X(z,x)$ and thus $X(x,y) \geq \sup_{z}X(z,y)-X(x,z)$, and conversely, from $X(x,y)-X(x,x)=X(x,y)$ it follows
%%$X(x,y) \leq \sup_{z}X(z,y)-X(x,z)$.
%

Moreover, for all $x\in [X,Q]$, we have $\B Y(\sup x)\geq x$:  
\begin{align*}
\B Y(\sup x)(a) &= X(a,\sup x)\\
&= X(  \sup(\B Y(a)),\sup x) \\
& \geq [X,Q]( \B Y(a), x)\\
&\geq x_{a}-\B Y(a)(a) \\
&=
 x_{a}-X(a,a)  = x_{a}
\end{align*}
%where in the last step we use the fact that 
%$[X,Q](  \B Y(a),x)= \sup_{b}x_{b}-X(a,b) = x_{a}$.
%
%$ y\in \Lawv^{X}$, 
% $\| \B Y(\sup x)-  y\|_{\infty}=\| \B Y(\sup x)- x\|_{\infty}$. Indeed we have 
% \begin{align*}
% \| x_{a}-\B Y(\sup x)\|_{\infty}&= \sup_{a\in X}|
%x_{a}-\B Y(\sup x)(a)|\\ 
%&=
%\sup_{a\in X}|
%x_{a}-X(\sup x,a)|\\
% &=
%\sup_{a\in X}\inf_{a'\in X}| x_{a}+X(a',a) -x_{a'}|\\
%&= \sup_{a\in X}|x_{a}+ X(a,a)- x_{a}| = 0
% \end{align*}
%
% 

Conversely, if $\sup$ is well-defined and adjoint to $\B Y$, then 
given $\Phi: Y\pfun \{\star\}$ and $f:Y\to X$, 
we can define
$\mathrm{colim}(\Phi, f):= \sup\Psi$, where $\Psi=
 f^{\circ}\cdot \Phi: X\pfun \{\star\}$, since 
\begin{align*}
X(\sup \Psi, y)&=
\sup_{z\in X}X(z,y)-\Psi(z) \\
&=\sup_{z\in X}X(z,y)- \inf_{y\in Y}X(z,f(y))  +\Phi(y)\\
& = \sup_{z\in X}\sup_{y\in Y}X(z,y)-X(z,f(y))  -\Phi(y)\\
&=
\sup_{z\in X} X(f(z),y) - \Phi(z)
\end{align*}
\end{proof}



\begin{definition}[MacNeill Completion]
Let $X$ be a $\Lawv$-category. For all $f: \{\star\}\pfun X$ and $g:X\pfun \{\star\}$, let $f \coh g$ iff 
$f  = X\multimapinv g $ and 
$g = f\multimap X$. 
The \emph{MacNeill completion of $X$} is the $\Lawv$-category $\B M(X)$ made of those 
$f:\{\star\}\pfun X$ such that $f\coh g$ for some $g:X\pfun \{\star\}$, with
$\B M(X)(f,f')=[X,Q](f,f')$. 
\end{definition}


Observe that if $f\coh g$, then $f= X\multimapinv (f\multimap X)$, i.e.:
\begin{align}
f(x)=  \sup_{y\in X}\inf_{z\in X}X(x,y)-X(y,z) +f(z)       
\tag{COH}
\end{align}




\begin{proposition}
Let $X$ be a skeletal $\Lawv$-category. 
If $X$ is complete, then $\B Y$ is an isomorphism between $X$ and $\B M(X)$. 
\end{proposition}
\begin{proof}
For all $x\in X$, one can check that $\B Y(x)\in \B M(X)$. Indeed, we can check that $\B Y(a) \coh \B Y^{\mathrm{op}}(a)$:
\begin{align*}
\B Y(a)(b)  &= X(b,a) \\
&=  \sup_{c\in X}X(b,c  )- X(a,c)\\
&= \sup_{c\in X}X(b,c  )- \B Y^{\mathrm{op}}(a)(c)\\
 &= (X\multimapinv \B Y^{\mathrm{op}}(a))(b)
\end{align*}
Since $\sup\B Y(a) \simeq a$ holds, it suffices to show that if $x \coh  y$, then 
$\B Y(\sup x)=x$: 
\begin{align*}
\B Y(\sup x)(a) & \ \ = X(a, \sup x) \\
&\ \ = \sup_{b\in X}X(a,b)-X(\sup x, b) \\
&\ \ = \sup_{b\in X}\inf_{c\in X}X(a,b)- X(b,c) + x_{c} \\
 &\stackrel{{\tiny\text{(COH)}}}{=} x_{a}
\end{align*}
\end{proof}


%
%\begin{remark}[other notions of completeness]
%The categorical notion of completeness subsumes several other notions of completeness, in the sense of being (strictly) stronger:
%\begin{itemize}
%\item \emph{order-completeness} is the case when the pre-order $\preceq_{X}$ is complete.   
%Let $I\subseteq X$, so that $\mathrm{id}_{I}$ can be seen as a functor from the subcategory $I$ to $X$. Let $0_{I}: \{\star\}\pfun I$ be the distributor given by $(0_{I})_{i}=0$.
%Then $\mathrm{colim}(0_{I}, \mathrm{id}_{I})$ coincides with $\inf I$, via 
%$$
%X(\inf I, x) = \sup_{i\in I}X(i, x)
%$$
%Notice that in general an order-complete $\Lawv$-category needs not be tensored, and thus it needs not be complete.
%
%
%
%
% 
%
%\item \emph{Cauchy-completeness} is the case where $X$ contains the points $\sup x, \sup y$, for any 
% any two \emph{adjoint} presheaves $x, y\in [X,Q]$, i.e.~satisfying $0=\inf_{a}x_{a}+ y_{a}$ and $x_{a}+ x_{b}\geq X(a,b)$. 
% Notice that given a pair $(x,  y)$ we can define a Cauchy sequence by finding $a_{n}$ satisfying 
% $x_{a_{n}}+ y_{a_{n}}\leq \frac{1}{n}$. Indeed this implies $X(a_{n},a_{n+1})\leq x_{a_{n}}+ y_{a_{n+1}}\leq x_{a_{n}}+ y_{a_{n}}+x_{a_{n+1}}+ y_{a_{n+1}}=\frac{1}{n}+\frac{1}{n+1}$.
% Conversely, any (equivalence class of) Cauchy sequences $a_{n}$ yields an adjoint pair given by
% $x_{a}= \lim_{n}X(a_{n},a)$ and $ y_{a}=\lim_{n}X(a,a_{n})$. 
% 
%% 
%% \item \emph{Isbell-completeness} (or \emph{MacNeill completeness}) is the case where $X$ contains the points $\sup x, \sup  y$, for any two presheaves $x,  y\in [X,Q]$ satisfying 
%% $
%% x_{a}= \sup_{b\in X}X(b,a)- y_{b}
%% $.
%
%
%\end{itemize}
%
%\end{remark}

From now on, all $\Lawv$-categories will be tacitly assumed to be skeletal. As observed in Section \ref{section6}, any $\Lawv$-category $X$ can be made skeletal by a suitable quotient.


\subsubsection{Tensors and $\Lawv$-Modules}

%Among weighted colimits, one is of big importance for us. 
%Any $\epsilon \in Q$ generates a constant distributor $(\epsilon):\{\star\}\pfun \{\star\}$, and any point $x\in X$ generates a constant functor $\Delta x: \{\star\}\to X$.
%Given a $\Lawv$-category $X$, a point $x\in X$ and  $\epsilon \in Q$, the \emph{tensor of $x$ and $\epsilon$}, if it exists, is defined as
%$$
%\epsilon \otimes x := \mathrm{colim}((\epsilon), \Delta x)
%$$
\begin{definition}
A $\Lawv$-category $X$ is said \emph{tensored} if for all $x\in X$ and $\epsilon \in Q$, it admits the tensor $\epsilon \otimes x$.
\end{definition}

\begin{proposition}
A tensored $\Lawv$-category $X$ is a $\Lawv$-module $(X, \preceq_{X}, \otimes)$.
A continuous functor of complete $\Lawv$-categories is a $\Lawv$-module morphism between the associated $\Lawv$-modules.
\end{proposition}
\begin{proof}
We must show that tensors induce a continuous action. Observe that tensors are characterized by the equation 
\begin{align}\label{eq:tensor}
X(x\otimes \epsilon, x') = X(x,x') -\epsilon
\end{align}
If $\epsilon=0$, then \eqref{eq:tensor} forces $x\otimes \epsilon\simeq x$. 
If $\epsilon=\delta+\eta$, then using the fact that $\alpha-(\epsilon+\delta)=(\alpha-\epsilon)-\delta$ 
we deduce $X((x\otimes \epsilon)\otimes \delta, x')=X(x\otimes \epsilon, x')-\delta=(X(x,x')-\epsilon)-\delta=X(x,x')-(\epsilon+\delta)=X(x\otimes (\epsilon+\delta),x')$, which forces $x\otimes(\epsilon+\delta)\simeq (x\otimes \epsilon)\otimes \delta$.

A continuous functor $f:X\to Y$ commutes with sups and with $\otimes$, and is thus a $\Lawv$-module morphism.
\end{proof}


\begin{lemma}
\begin{itemize}
\item[i.] $\sup_{i\in I}a_{i}-\epsilon= (\sup_{i\in I}a_{i})-\epsilon$.
\item[ii.] $\sup_{i\in I}(a_{i}-\epsilon)-b_{i}= (\sup_{i\in I}a_{i}-b_{i})-\epsilon$.


\end{itemize}
\end{lemma}
\begin{proof}
Let $A= \sup_{i\in I}a_{i}-\epsilon$ and $B= (\sup_{i\in I}a_{i})-\epsilon$.
Let $J\subseteq I$ be the set of indexes $j$ such that $a_{j}>\epsilon$. 
If $J=\emptyset$ then $A=B=0$. Otherwise, 
$A= \sup_{j\in J}a_{j}-\epsilon$ (where ``$-$'' can be interpreted as subtraction on $\BB R$, and 
$B= (\sup_{j\in J}a_{j})-\epsilon$ (again with ``$-$'' being subtraction on $\BB R$), so $A=B$ follows from the continuity of ``$-$'' on $\BB R$.

Let now $A= \sup_{i\in I}(a_{i}-\epsilon)-b_{i}$ and $B= (\sup_{i\in I}a_{i}-b_{i})-\epsilon$.
Let $J\subseteq I$ be the set of indexes $j$ such that $a_{j}> b_{j}+\epsilon$.
If $J=\emptyset$, then $A=0$; suppose $B>0$, then $\sup_{i\in I}a_{i}-b_{i}>\epsilon$, but this implies that we can find $i\in I$ with $a_{i}>b_{i}+\epsilon$, against the assumption, so also $B=0$ holds. If $J$ is non-empty, then 
$A= \sup_{j\in J}(a_{j}-\epsilon)-b_{j}$, where ``$-$'' is not subtraction on $\BB R$ and 
$B= (\sup_{j\in J}a_{j}-b_{j})-\epsilon$, again with ``$-$'' usual subtraction, so $A=B$ follows from the continuity of ``$-$'' on $\BB R$.
 \end{proof}


\begin{lemma}
In any complete $\Lawv$-category, $x\otimes \epsilon \simeq \sup(  \B Y(x)+\epsilon  )$.
In the complete $\Lawv$-category $[X,Q]$, $x\otimes \epsilon= x+\epsilon$.
\end{lemma}
\begin{proof}
We have 
\begin{align*}
X(\sup(\B Y(x)+\epsilon), x')& =\sup_{y\in X}X(z,x')- (\B Y(x)(z)+\epsilon)\\
&= \sup_{y\in X}X(z,x')-(X(z,x)+\epsilon)\\
&= (\sup_{y\in X}X(z,x')-X(z,x))-\epsilon\\
&= X(x,x')-\epsilon
\end{align*}
which shows $x\otimes \epsilon=\sup(\B Y(x)+\epsilon)$. In $[X,Q]$ we have 
$[X,Q](x+\epsilon, x')=\sup_{a\in X}(x_{a}+\epsilon)-x'_{a}= (\sup_{a\in X}x_{a}-x'_{a})-\epsilon= [X,Q](x, x')-\epsilon$, which shows $x\otimes \epsilon \simeq x+\epsilon$, and since $[X,Q]$ is skeletal, $x\otimes \epsilon=x+\epsilon$.
\end{proof}


The dual notion of tensors is the \emph{cotensor} $x\multimapinv \epsilon$. Formally, it is defined as a \emph{weighted limit} (whose definition is dual to that of weighted colimit but we do not give details here), and characterized by the equation
\begin{align*}
X(x', x\multimapinv \epsilon)= X(x',x)-\epsilon
\end{align*}
In other words, in a tensored and cotensored $\Lawv$-category we have $X(x\otimes \epsilon,y)= X(x,y\multimapinv \epsilon)$. 

\begin{example}
The $\Lawv$-category $[X,Q]$ is cotensored, with $x\multimapinv \epsilon:= x-\epsilon$. Indeed we have $[X,Q](x,  y\multimapinv \epsilon)=\sup_{a\in X}( y_{a}-\epsilon)-x_{a}=(\sup_{a\in X} y_{a}-x_{a})-\epsilon= [X,Q](x,  y)-\epsilon$.
\end{example}

\begin{definition}
A $\Lawv$-category $X$ is \emph{order-complete} if it is a sup-lattice with respect to the order $\preceq_{X}$ (i.e.~all joins exist).
\end{definition}


\begin{lemma}\label{lemma:supinf}
Let $X$ be a $\Lawv$-category. If $X$ is order-complete, then 
\begin{itemize}
\item if $X$ is co-tensored, $X(\bigvee_{i}x_{i},y)=  \sup_{i}X(x_{i},y) $;
\item if $X$ is tensored, $
X(x,\bigvee_{i}y_{i})=  \inf_{i}X(x,y_{i})$.

\end{itemize}
\end{lemma}
\begin{proof}
We only prove the second claim, the first being proved similarly.

 Let us show that $z\preceq_{X}z'$ iff for all $w\in X$, $X(w,z')\leq X(w,z)$: 
 on one direction we have $X(w,z')\leq X(w,z)+X(z,z')=X(w,z)$; on the other direction, 
 we have $X(z,z')\leq X(z,z)=0$. 
 
 Using this, since $y_{i}\preceq_{X}y:=\bigvee_{i}y_{i}$ we deduce 
 $X(x,y_{i})\leq X(x,y)$, and thus $X(x,y)\geq \inf_{i}X(x,y_{i})$. 
 
 
 For the converse direction, we argue as follows: let $X(x,y_{i})\leq \epsilon$ hold for all $i\in I$; then $0=X(x,y_{i})-\epsilon= X(x\otimes\epsilon,y_{i})$. Thus $x\otimes\epsilon\preceq_{X}y_{i}$, and thus
 $x\otimes\epsilon\preceq_{X}y$, that is $X(x\otimes\epsilon,y)=X(x,y)-\epsilon=0$, and consequently $X(x,y)\leq \epsilon$. 
 By letting $\epsilon:=X(x,y_{i})$ we conclude then $X(x,y)\leq X(x,y_{i})$, and thus $X(x,y)\leq \inf_{i}X(x,y_{i})$.
 
  
%
%First, if $
%By definition $x:=\bigvee_{i}x_{i}$ is characterized by (1) $X(x_{i},x)=0$ for all $i\in I$, and 
% (2) $X(x,y)=0$, for all $y$ such that $X(x_{i},y)=0$ holds for all $i\in I$.
%% 
%% Let us show that $z\preceq_{X}z'$ implies $X(z',y) \leq X(z,y)$: 
%% from $z\preceq_{X}z'$ we deduce $X(z,z')=0$, whence $
%% 
% Let now $y\in X$; 
% then $X(x_{i},y)\leq X(x_{i},x)+X(x,y)=X(x,y)$, which implies $\sup_{i}X(x_{i},y)\leq X(x,y)$.
% 
%
% 
% 
% Suppose now that, for some $i\in I$, $X(x_{i},y)>0$; then $X(x,y)\leq X(x,x_{i})+X(x_{i},y)$
% 
% 
%If $X(x_{i},y) \leq \epsilon$, for all $i\in I$, then 
%$0= X(x_{i},y)-\epsilon = X(x_{i},y\multimapinv \epsilon)$. Thus 
%$x_{i}\preceq_{X}y\multimapinv\epsilon$ and we deduce 
%$x\preceq_{X}y\multimapinv \epsilon$. Hence
%$0= X(x, y\multimapinv \epsilon)=X(x,y)-\epsilon$ and consequently
%$ X(x,y)\leq \epsilon$.  
 


\end{proof}

\begin{proposition}\label{prop:tencoten}
If a $\Lawv$-category $X$ is tensored, cotensored and order-complete, then it is complete.
\end{proposition}
\begin{proof}
For all $x\in [X,Q]$, let $\sup x:= \bigvee_{a\in X}a\otimes x_{a}$. 
Let us check that $X(\sup x, b)= \sup_{a\in X}X(a,b)-x_{a}$, using Lemma \ref{lemma:supinf}:
\begin{align*}
X(\sup x, b) &= \sup_{a\in X}X(a\otimes x_{a},b)\\
&=\sup_{a\in X}X(a,b)-x_{a}
\end{align*}
We can thus conclude using Proposition \ref{prop:yonedasup}.
\end{proof}

\begin{proposition}\label{prop:tenfun}
Let $X,Y$ be two tensored $\Lawv$-categories, and $f:X\to Y$ be a function.
\begin{itemize}
\item[i.] $f$ is a functor iff $f$ is order-preserving and for all $x\in X$ and $\epsilon\in Q$, $f(x)\otimes \epsilon \preceq_{Y} f(x\otimes \epsilon)$.

\item[ii.] $f$ is a continuous functor iff $f$ commutes with joins and for all $x\in X$ and $\epsilon\in Q$, $f(x)\otimes \epsilon = f(x\otimes \epsilon)$.
\end{itemize}
\end{proposition}
\begin{proof}
\begin{itemize}
\item[i.] If $f$ is a functor then 
\begin{align*}
Y(f(x)\otimes \epsilon, f(x\otimes \epsilon))&= Y(f(x), f(x\otimes \epsilon)) -\epsilon \\
&\leq X(x, x\otimes \epsilon)-\epsilon \\
&= X(x\otimes \epsilon, x\otimes \epsilon)=0
\end{align*}
so $Y(f(x)\otimes \epsilon, f(x\otimes \epsilon))=0$, which implies
$f(x)\otimes \epsilon \preceq_{X}f(x\otimes \epsilon)$. 
Moreover, if $x\preceq_{X}x'$, then $0\geq X(x,x')\geq Y(f(x),f(x'))$, whence 
$f(x)\preceq_{Y}f(x')$, so $f$ is order-preserving. 

Conversely, for all $x,x'\in X$, 
\begin{align*}
X(x\otimes X(x,x'), x') &=X(x,x')-X(x,x')=0 
\end{align*}
thus $x\otimes X(x,x') \preceq_{X}x'$. Since $f$ is order-preserving, it follows that
\begin{align*}
f(x)\otimes X(x,x') \preceq_{Y}f(x\otimes X(x,x'))\preceq_{Y}f(x') 
\end{align*}
which implies that 
\begin{align*}
Y(f(x),f(x')) - X(x,x') = Y(f(x)\otimes X(x,x'), f(x'))=0
\end{align*}
that is $Y(f(x),f(x'))\leq X(x,x')$, so $f$ is a functor. 

\item[ii.]
Suppose $f$ is a continuous functors, and let  $g:Y\to X$, be its right-adjoint, i.e.~satisfying $Y(f(x),y)=X(x,g(y))$. Then 
\begin{align*}
Y(f(x\otimes \epsilon), y)& = X(x\otimes \epsilon, g(y)) \\
&= X(x, g(y))-\epsilon \\
&= Y(f(x), y)-\epsilon
\end{align*}
which implies that $f(x\otimes \epsilon)$ coincides with the tensor $f(x)\otimes \epsilon$. 
Moreover, clearly also $f(x)\preceq_{Y}y$ iff $x\preceq_{X}g(y)$ holds, which means that $f$ is left-adjoint to $g$ also with respect to the order. 

Conversely, suppose the function $f:X\to Y$ preserves joins and tensors. Since $f$ is order-preserving, by i.~it is a functor, so we must only prove that it is continuous.
Since $f$ preserves joins there exists a function $g:Y\to X$ which is right-adjoint to $f$ with respect to orders, i.e.~$f(x)\preceq_{Y}y$ iff $x\preceq_{X}g(y)$. 
We need to prove then that $f$ is left-adjoint to $g$, i.e.~that $Y(f(x),y)=X(x,g(y))$.

On the one hand we have 
\begin{align*}
0 = X(x, g(y))-X(x,g(y))= X(x\otimes X(x,g(y)), g(y))
\end{align*}
from which it follows
\begin{align*}
0= Y(f(x\otimes X(x,g(y)), y)=Y(f(x)\otimes X(x,g(y)), y)=
Y(f(x),y)-X(x,g(y))
\end{align*}
where the first inequality follows from the fact that $f$ and $g$ are adjoint with respect to the order (so $Y(f(x),y)=0$ iff $X(x,g(y))=0$).
This implies then $Y(f(x),y)\leq X(x,g(y))$. 

For the converse inequality, 
\begin{align*}
0=Y(f(x),y)-Y(f(x)-y)=Y(f(x)\otimes Y(f(x),y),y)=
Y(f(x\otimes Y(f(x),y)),y)
\end{align*}
and by a similar reasoning we deduce
\begin{align*}
0=X(x\otimes Y(f(x),y), g(y))=
X(x,g(y))-Y(f(x),y)
\end{align*}
whence $X(x,g(y))\leq Y(f(x),y)$.
\end{itemize}
\end{proof}


\begin{theorem}\label{thm:equivalence}
The category $\Mod$ of $\Lawv$-modules and $\Lawv$-module morphism coincides with the category $\GMet$ of complete skeletal $\Lawv$-categories and continuous functors.
\end{theorem}
\begin{proof}
We have already seen that any complete skeletal $\Lawv$-category is a $\Lawv$-module via tensors, 
and that continuous functors are $\Lawv$-module morphisms.
Let us now show that any $\Lawv$-module is a complete skeletal $\Lawv$-category, and that a $\Lawv$-module morphism is a continuous functor.

Let then $M=(M,\preceq, \star)$ be a $\Lawv$-module. Define $M(x,y)= \inf\{ \delta \mid x\star \delta \succeq y\}$.
 It is clear that $M(x,x)=0$. Let us prove $M(x,y)+M(y,z) \succeq M(x,z)$: 
from $x\star M(x,y)\succeq y$ and $y\star M(y,z)\succeq z$ we deduce 
$x\star(M(x,y)+M(y,z))= (x\star M(x,y))\star M(y,z) \succeq y\star M(y,z)\succeq z$, and thus 
$M(x,z)\preceq M(x,y)+M(y,z)$. 
Observe that $M(x,y)=0$ iff $x=x\star 0\geq y$, so the order $\preceq_{M}$ coincides with the order of $M$.

Let us check that the $\Lawv$-category $M$ is tensored via $x\otimes \epsilon:=x\star\epsilon$.
Let $A_{x,y}= \{ \delta \mid (x\star\epsilon)\star \delta \geq y$ and 
$B_{x,y}=\{\delta-\epsilon\mid x\star \delta \geq y\}$.
Let us show that $A_{x,y}=B_{x,y}$: if $\delta \in A_{x,y}$, then 
$\delta=(\epsilon+\delta)-\epsilon$ satisfies 
$x\star(\epsilon+\delta)=(x\star\epsilon)\star \delta \geq y$, whence 
$\delta\in B_{x,y}$. Conversely, if $\eta=\delta-\epsilon\in B_{x,y}$, then 
$(x\star\epsilon)\star \eta \geq x\star \delta \geq y$, whence $\eta\in A_{x,y}$.
We conclude then that $M(x\star\epsilon,y)=\inf A_{x,y}=\inf B_{x,y}=
\inf\{\delta \mid x\star \delta \geq y\}-\epsilon=M(x,y)-\epsilon$.


Let us define the opposite action $x\multimapinv \epsilon= \bigwedge\{y \mid 
y\star \epsilon \geq x\}$. We must show that $M$ is cotensored via $\multimapinv$, for which it suffices to show $M(x\star \epsilon,y)=M(x,y\multimapinv \epsilon)$. Let $C_{x,y}=\{\delta \mid 
x\star \delta \geq y\multimapinv \epsilon\}$. We have that $\delta \in A_{x,y}$ iff  
$(x\star \delta)\star \epsilon=x\star(\delta+\epsilon)=x\star(\epsilon+\delta)=(x\star \epsilon)\star \delta \geq y$ which is equivalent to $x\star\delta \geq y\multimapinv \epsilon$. We conclude that $A_{x,y}=C_{x,y}$, from which $M(x\star \epsilon,y)=\inf A_{x,y}=\inf C_{x,y}=M(x,y\multimapinv \epsilon)$.



Since $M$, as a $\Lawv$-category, is order-complete, tensored and cotensored, it is complete by Proposition \ref{prop:tencoten}.


To conclude, notice that if $f:X\to Y$ is a continuous functor, then it commutes with tensors and, by 
Proposition \ref{prop:tenfun} it commutes with joins, so it is a morphism of the respective $\Lawv$-modules. Conversely, if $f:M\to N$ is a $\Lawv$-module morphism, then, since $M$ and $N$ are both tensored $\Lawv$-categories, the tensor coincides with the actions of $M$ and $N$, $f$ preserves the joins and the tensor, by Proposition \ref{prop:tenfun}, it is a continuous functor of the respective $\Lawv$-categories.
\end{proof}


\subsection{$\Mod$ is a $*$-Autonomous Category}

%
%
%Let us first observe that:
%\begin{itemize}
%\item the hom-set $\Mod(M,N)$ of two $\Lawv$-modules is a $\Lawv$-module with order and action defined pointwise;
%
%\item for any $\Lawv$-module $M=(M,\preceq, \star)$, there is a $\Lawv$-module
%$M^{\mathrm{op}}=(M,\succeq, \multimapinv)$, with $\multimapinv$ defined as in the proof of Theorem \ref{thm:equivalence}.
%
%
%\end{itemize}
%
%
%
%Let $M,N$ be two $\Lawv$-modules. For all $A\in \Lawv^{M\times N}$, we define the function
%\begin{align*}
%H_{A} & : \Lawv^{M} \longrightarrow \Lawv^{N}%\\
%%K_{A} & : \Lawv^{N} \longrightarrow \Lawv^{M}
%\end{align*}
%via
%\begin{align*}
%H_{A}(x)(b)  &= \inf_{a\in M}x_{a}+A(a,b)\\
%%K_{A}(x)(b)  &= \sup_{a\in M}x_{a}-A(a,b)
%\end{align*}
%
%
%\begin{lemma}
%$H_{A}=H_{A'}$ iff $A=A'$. 
%\end{lemma}
%\begin{proof}
%We only need to prove one direction, so suppose $A\neq A'$ and let $a,b$ be such that $A(a,b)\neq A'(a,b)$.
%Let $x$ be defined by $x_{a}=1$ and $x_{a'}=\infty$ for all $a'\neq a$. Then $H_{A}(x)(b)=A(a,b)\neq A'(a,b)=H_{A'}(x)(b)$. 
%\end{proof}
%
%\begin{proposition}
%$\Lawv^{M\times N}$ and $\Mod(\Lawv^{M},\Lawv^{N})$ are isomorphic $\Lawv$-modules.
%\end{proposition}
%\begin{proof}
%The map $A\mapsto H_{A}$ is injective, as shown above. We need to check that it commutes with joins:
%\begin{align*}
%H_{\bigvee_{i}A_{i}}(x)(b) & = \inf_{a}x_{a}+\bigvee_{i}A_{i}(a,b)\\
%&=  \inf_{a}\bigvee_{i}x_{a}+A_{i}(a,b)\\
%&=  \bigvee_{i}\inf_{a}x_{a}+A_{i}(a,b)\\
%&=  \bigvee_{i}H_{A_{i}}(x)(b)\end{align*} 
%(recall that $\inf$s are actually joins in $\Lawv$!)
%
%We must prove that $H$ is surjective: for all $f\in \Mod(\Lawv^{M},\Lawv^{N})$, let 
%$k_{f}\in \Lawv^{M\times N}$ be given by $k_{f}(a,b)=f(e_{a})(b)$. 
%
%Then we have 
%\begin{align*}
%H_{k_{f}}(x)(b) & = \inf_{a}x_{a}+k_{f}(a,b) \\
%&= \inf_{a}x_{a}+ f(e_{a})(b)\\
%&= \left(\inf_{a}x_{a}+f(e_{a})\right)(b) \\
%&= \left(\inf_{a}f(x_{a}+e_{a})\right)(b) \\
%&= f(\inf_{a}x_{a}+e_{a})(b)\\
%&=
%f(x)(b)
%\end{align*}
%and conversely 
%\begin{align*}
%k_{H_{A}}(a,b)&= H_{A}(e_{a})(b)= \inf_{a'}(e_{a})_{a'}+A(a',b) =  A(a,b)
%\end{align*}
%\end{proof}
%
%
%More generally, we have the following result:
%\begin{proposition}
%Let $X,Y$ be two $\Lawv$-modules. For any morphism $f: X\to Y$ there is a matrix $k_{f}\in \Lawv^{X\times Y}$ such that 
%
%\end{proposition}
%\begin{proof}
%By composing $f$ with the isomorphisms $\B Y^{\mathrm{op}}:X\to \B M(X)$, with inverse $\sup(x)=\bigvee_{a\in x}a\otimes x_{a}$, we obtain 
%a morphism $\widehat f: \B M(X)\to \B M(Y)$  
%\begin{align*}
%\widehat f(x)(b)&:= \B Y^{\mathrm{op}}(f(\sup x))(b) \\
%&= Y( f(\bigvee_{a\in X}a\otimes x_{a}),b) \\
%&= Y( \bigvee_{a\in X}f(a)\otimes x_{a},b) \\
%&= \sup_{a\in X}Y(f(a),b)-x_{a}
%\end{align*}
%Observe that $\widehat f$ can be extended to a function $f^{*}$ from $\Lawv^{X}$ to $\Lawv^{Y}$.
%Now, $ f^{*}$ is generated by the matrix $k_{f}\in \Lawv^{X\times Y}$ given by $k_{ f}(a,b)=f(e_{a})(b)$, so that for all $x\in \Lawv^{X}$, 
%$f^{*}(x)(b)=\bigvee_{a\in X}k_{f}(a,b)+x_{a}$, and thus
%in particular, for all $x\in [X,Q]$, 
%$\widehat f(x)(b)=f^{*}(x)(b)$.
%\end{proof}

\subsubsection{The Tensor Product of $\Lawv$-Modules}
%
% Let us first recall some important definitions:
%
%\begin{definition}[congruence on a sup-lattice]
%Let $(L, \leq)$ be a sup-lattice. An equivalence relation $R\subseteq L\times L$ is said a \emph{congruence} if it satisfies the following property:
%\begin{align}
%(\forall i\in I \ x_{i} Ry_{i})  \ \To  \ \left( \bigvee_{i}x_{i} \right ) R\left(\bigvee_{i}y_{i}\right)
%\tag{congruence}
%\end{align}
%\end{definition}
%
%\begin{lemma}
%For all suplattices $(L,\leq)$, if $R$ is a congruence, then $(L/R, \leq_{R})$ is a sup-lattice, where $[x]\leq_{R}[y]$ iff $(x\vee y) R y$ (i.e.~$[x\vee y]=[y]$), and $\bigvee_{i}[x_{i}]=\left [\bigvee_{i}x_{i}\right]$.
%\end{lemma}
%\begin{proof}
%Let us check that $\leq_{R}$ is an order. It is clear that $[x]\leq_{R}[x]$ holds. If $[x]\leq_{R}[y]$ and $[y]\leq_{R}[z]$ both hold, then 
%$(x\vee y)Ry$ and $(y\vee z)Rz$ hold; 
%then, since $R$ is a congruence $((x\vee y)\vee (y\vee z)) R (y\vee z)R z$, and moreover $x \vee (y\vee z) R (x \vee z)$, whence 
%$(x\vee z) R(x \vee y\vee z)R z$, so $[x]\leq_{R}[z]$.  
%If $[x]\leq_{R}[y]$ and $[y]\leq_{R}[x]$, then 
%$xR(x\vee y)R y$, thus $[x]=[y]$.
%
%Let us now check the definition of joins. 
%From $[x_{i}]\vee [\bigvee_{i}x_{i}]=[x_{i}\vee \bigvee_{i}x_{i}]= [\bigvee_{i}x_{i}]$ we deduce $[x_{i}]\leq_{R}[\bigvee x_{i}]$.
%Suppose now $[x_{i}]\leq [y]$ holds for all $i\in I$, that is, 
%$(x_{i}\vee y)Ry$; then, since $R$ is a congruence, 
%$(\bigvee_{i}(x_{i}\vee y))R y$, that is, 
%$((\bigvee_{i}x_{i})\vee y)Ry$, which implies 
%$[\bigvee_{i}x_{i}]\leq_{R}[y]$. We conclude then that $\bigvee_{i}[x_{i}]=[\bigvee_{i}x_{i}]$.
%\end{proof}
%
%
%\begin{corollary}\label{cor:bigvee}
%Let $(L,\leq)$ be a suplattice and $R$ be a congruence on $L$.
%Then, for any class $\beta\in L/R$, $\beta= [\bigvee\beta]$.
%\end{corollary}
%\begin{proof}
%$[\bigvee \beta]=[\bigvee\{ x \mid x\in \beta\}]= \bigvee \{[x]\mid x\in \beta\}=\beta$.
%\end{proof}
%
%
%\begin{proposition}\label{prop:smallestcongruence}
%Let $(L,\leq)$ be a sup-lattice. Let $R\subseteq L\times L$ be an equivalence relation, and for any ordinal $\alpha$, let the relation
%$R^{(\alpha)}\subseteq L\times L$ be defined by:
%\begin{itemize}
%\item $xR^{(0)}y$ iff either $xRy$, $x=y$ or $yRx$ holds;
%\item $xR^{(\alpha+1)}y$ iff one of the following holds:
%	\begin{itemize}
%	\item for some $z$, $xR^{(\alpha)}z$ and $zR^{(\alpha)}y$ holds;
%	\item for some set $I$, and families $x_{i},y_{i}$, 
%	$x=\bigvee x_{i}, y=\bigvee_{i}y_{i}$ and $x_{i} R^{(\alpha)}y_{i}$ holds for all $i\in I$.
%
%	\end{itemize}
%\item $xR^{(\gamma)}y$ iff $xR^{(\delta)}y$ holds for some $\delta <\gamma$, for $\gamma$ limit.
%\end{itemize}
%Then the relation $R^{*}\subseteq L\times L$ given by 
%$$
%xR^{*} y  \ \Leftrightarrow \ \exists \alpha . \mathrm{OR}(\alpha) \land xR^{(\alpha)}y
%$$% defined as follows: $xR^{*} y$ iff
%%\begin{enumerate}
%%\item for any set $I$ and family $x_{i}$ such that $x=\bigvee_{i}x_{i}$, there exists a family $y_{i}$ such that $y=\bigvee_{i}y_{i}$ and $x_{i}R y_{i}$ holds for all $i\in I$;
%%\item for any set $I$ and family $y_{i}$ such that $y=\bigvee_{i}y_{i}$, there exists a family $x_{i}$ such that $x=\bigvee_{i}x_{i}$ and $x_{i}R y_{i}$ holds for all $i\in I$.
%%\end{enumerate}
%%%\begin{align*}
%%%xR^{*}y &\text{ iff }\  \forall I \ \forall x_{i} \  \text{ s.t. }
%%%\left\{
%%%\begin{matrix}
%%%x=\bigvee_{i\in I}x_{i} \\
%%%y=\bigvee_{i\in I}y_{i}\\
%%%x_{i}Ry_{i} \ (\forall i\in I)
%%%\end{matrix}
%%%\right\}
%%%\end{align*}
%where $\mathrm{OR}(\alpha)$ is the property ``$\alpha$ is an ordinal'', 
%is a congruence, and is the smallest congruence containing $R$.
%\end{proposition}
%\begin{proof}
%From $xR^{(0)}x$ it follows $xR^{*}x$.
%
%Let us prove by induction that for any ordinal $\alpha$, $R^{(\alpha)}$ is symmetric:
%for $\alpha=0$ this is immediate; suppose $xR^{(\alpha+1)}y$, then two cases are possible: either $xR^{(\alpha)}z$ and $zR^{(\alpha)}y$, then by IH 
%$yR^{(\alpha)}z$ and $zR^{(\alpha)}x$, whence $yR^{(\alpha+1)}x$; oer
%$x_{i}R^{(\alpha)}y_{i}$ for some decompositions $x=\bigvee_{i}x_{i}$ and $y=\bigvee_{i}y_{i}$; then by IH $y_{i}R^{(\alpha)}x_{i}$, so $yR^{(\alpha+1)}x$ holds.
%Finally, if $\alpha$ is limit, then from $x R^{(\alpha)}y$ it follows
%$xR^{(\beta)}y$ for some $\beta<\alpha$, whence 
%$yR^{(\beta)}x$ by IH and we conclude $yR^{(\alpha)}x$.
%
%Now, if $xR^{*}y$ then $xR^{(\alpha)}y$ holds for some ordinal $\alpha$, and thus $yR^{(\alpha)}x$ holds too, whence $yR^{*}x$.
%
%
%Observe that $\alpha<\beta$ implies $R^{(\alpha)}\subseteq R^{(\beta)}$:
%this is obvious if $\beta$ is limit, otherwise, if $\beta=\alpha+1$, from $xR^{(\alpha)}y$ and $x R^{(\alpha)}x$ we deduce
%$xR^{(\alpha+1)}y$.
%
%
%Suppose now $xR^{*}y$ and $yR^{*}z$. Then $xR^{(\alpha)}y$ and $yR^{(\beta)}z$ hold for some 
%ordinals $\alpha$ and $\beta$; let $\gamma=\max\{\alpha,\beta\}$; then 
%we have $xR^{(\gamma)}y$ and $yR^{(\gamma)}z$, whence $xR^{(\gamma+1)}z$ and thus 
%$xR^{*}z$.
%
%
%Suppose $x_{i}R^{*}y_{i}$ holds for all $i\in I$; then 
%for all $i$ there is some ordinal $\alpha_{i}$ with 
%$x_{i}R^{(\alpha_{i})}y_{i}$. 
%Let $\gamma=\sup_{i}\alpha_{i}$, so that 
%$x_{i}R^{(\gamma)}y_{i}$; then we have
%$\bigvee_{i}x_{i} R^{(\gamma+1)}\bigvee y_{i}$, and thus
%$\bigvee_{i}x_{i} R^{*}\bigvee_{i}y_{i}$.
%
%%
%%$R^{*}$ is symmetric, reflexive and transitive, given that $R$ is. 
%%
%%Let $I$ be a set and 
%%suppose $x_{i}R^{*}y_{i}$ holds for all $i\in I$.
%%Observe now that if $x=\bigvee_{i\in I} x_{i}=\bigvee_{j\in J}x'_{j}$, then
%%\begin{enumerate}
%%\item $x_{i}=\bigvee_{j\in J}x_{i}\land x_{j}$;
%%\item $x= \bigvee_{(i,j)\in I\times J}x_{i}\land x'_{j}$. 
%%\end{enumerate}
%% $\bigvee_{j\in J}x_{i}\land x_{j}\leq x_{i} \leq x_{i}$ is clear.
%% Conversely, we have $x_{i}= x \land x_{i} = \left (\bigvee_{j\in J}x_{j}\right) \land x_{i}= \bigvee_{j\in J}x_{j}\land x_{i}= \bigvee_{j\in J}x_{i}\land x_{j}$. {\color{red}NOT TRUE IN ANY LATTICE!}
% 
%%
%% Then for each $i\in I$ there exists a set $J_{i}$ and sequences $x_{ij},y_{ij}$ such that 
%%$\bigvee_{j\in J_{i}}x_{ij}=x_{i}$, $\bigvee_{j\in J_{i}}y_{ij}=y_{i}$ and 
%%$x_{ij}Ry_{ij}$.
%%
%%Let then $K= \prod_{i\in I}\{i\}\times J_{i}$; then for all $(i,j)\in K$, 
%%$x_{ij}R y_{ij}$, so we deduce that $\bigvee_{i\in I}x_{i}=\bigvee_{(i,j)\in K}x_{ij} R^{*} \bigvee_{(i,j)\in K}y_{ij}=\bigvee_{i\in I}y_{i}$, which proves that $R^{*}$ is a congruence.
%
%Suppose now $S$ is a congruence containing $R$.
%Let us show that for any ordinal $\alpha$, $R^{(\alpha)}\subseteq S$:
%\begin{itemize}
%\item $R^{(0)}\subseteq S$ holds since $S$ is an equivalence relation and contains $R$;
%
%\item if $x R^{(\alpha+1)}y$ holds, then two cases occur:
%	\begin{itemize}
%	\item $xR^{(\alpha)}z$ and $zR^{(\alpha)}y$ hold, so by IH, 
%	$xSz$ and $zSy$, and since $S$ is transitive, $xSy$ holds;
%	\item $x=\bigvee_{i}x_{i}$, $y=\bigvee_{i}y_{i}$ and $x_{i}R^{(\alpha)}y_{i}$ holds; then by IH $x_{i}Sy_{i}$ holds, and since $S$ is a congruence, $xSy$ holds;
%	
%\item if $\alpha$ is limit and $xR^{(\alpha)}y$ holds, then $xR^{(\beta)}y$ holds for some $\beta<\alpha$, and by IH $xS y$ holds.
%	
%	\end{itemize}
%
%\end{itemize}
%Now, if $x R^{*} y$ holds, then $xR^{(\alpha)}y$ holds for some ordinal $\alpha$, whence $xS y$ holds.
%This shows that $R^{*}\subseteq S$.
%%
%%Then there exists a set $I$ so that $x=\bigvee_{i\in I}x_{i}$, $y=\bigvee_{i\in I}y_{i}$ and $x_{i}Ry_{i}$; now, since $S$ contains $R$, we deduce $x_{i}Sy_{i}$ for all $i\in I$, and since $S$ is a congruence, $xSy$ holds, which proves that $R^{*}\subseteq S$.
%\end{proof}

The tensor of $\Lawv$-modules can be introduced as a suitable quotient lattice. 

\begin{definition}[tensor of $\Lawv$-modules]
Let $M$ and $N$ be $\Lawv$-modules. The \emph{tensor product} $M\otimes N$ of $M$ and $N$ is the $\Lawv$-module defined as $\C P(M\times N)/ R^{*}$, where $R^{*}$ is the smallest congruence containing the relation $R$ defined by:
\begin{align*}
R'= \left\{
\begin{matrix}
\left((\bigvee A, y), \bigcup_{a\in A}\{(a,y)\}\right)\\
\left((x,\bigvee B), \bigcup_{b\in B}\{(x,b)\}\right)\\
(\{(x\star \epsilon,y)\}, \{(x,y\star\epsilon)\})
\end{matrix}
\ \Bigg \vert\ 
\begin{matrix}
A\subseteq M, y\in N \\
B\subseteq N, x\in M \\
\epsilon \in Q
\end{matrix}
\right\}
\end{align*}
and the action is defined via $[A]\star \epsilon= \bigvee\{[ \{(x\star\epsilon,y)\}]\mid 
(x,y)\in A\}$.
\end{definition}



Let a \emph{$\Lawv$-bimorphism} be a map $f:M\times N\to L$ such that $f$ preserves joins in each variable separately, and moreover $f(x,y\star \epsilon)=f(x\star\epsilon,y)$. A $\Lawv$-bimorphism $f:M\times N\to L$ is \emph{universal} if for all $L'$ and bimorphism $g:M\times N\to L'$ there is a unique sup-lattice homomorphism $h:L\to L'$ such that $g=h\circ f$.

\begin{proposition}[universal property of the tensor product, cf.~\cite{Russo2007}]
The tensor product $M\otimes N$ is the codomain of the universal $\Lawv$-bimorphism $M\times N \to M\otimes N$.
\end{proposition}


\begin{remark}

For any $x\in M$ and $y\in N$, we indicate as $x\otimes y$ the image of the pair $(x,y)$ under the universal $\Lawv$-bimorphism $\tau:M\times N\to M\otimes N$, or equivalently, as the $R^{*}$-equivalence class of $(x,y)$.
Since joins in $M\otimes N$ are given by  
$\bigvee_{i}[A_{i}]= [\bigcup_{i}A_{i}]$, we have then 
that any element $[A]\in M\otimes N$ can be written as 
$[A]= \bigvee\{x\otimes y\mid (x,y)\in A\}$.

%
% Any element of $M\otimes N$ is a join of tensors, that is
%$$
%M\otimes N= \left\{ \bigvee_{i\in I}x_{i}\otimes y_{i}\ \Bigg \vert \  x_{i}\in M, y_{i}\in N \right\}
%$$
\end{remark}



\begin{lemma}[cf.~\cite{Russo2007}]
\begin{itemize}
\item $M\otimes N\simeq N\otimes M$;

\item $(M\otimes N)\otimes R \simeq M\otimes (N\otimes R)$.
\end{itemize}
\end{lemma}

\begin{proposition}
$\Mod(M\otimes N, R)   \simeq   \Mod(M, \Mod(N,R))$ (as an isomorphism of sup-lattices).
\end{proposition}
\begin{proof}
Given $h:M\otimes N\to R$, for all $x\in M$ define $h_{x}:N\to R$ by 
$h_{x}(y)=h(x\otimes y)$. We then have 
$h_{x}(\bigvee_{i}y_{i})=h(x\otimes \bigvee_{i}y_{i})=
h(\bigvee_{i}x\otimes  y_{i})=
\bigvee_{i}h(x\otimes  y_{i})=\bigvee_{i}h_{x}(y_{i})$ and 
$h_{x}(y\star\epsilon)= h(x\otimes (y\star \epsilon))=h((x\otimes y)\star\epsilon)=h(x\otimes y)\star \epsilon= h_{x}(y)\star\epsilon$, so $h_{x}\in \Mod(N,R)$. Moreover, by a similar argument we have  $h_{\bigvee_{i}x_{i}}(y)=\bigvee_{i}h_{x_{i}}(y)$
and $h_{x\star\epsilon}(y)=h_{x}(y)\star\epsilon$, so the map $x\mapsto h_{x}$ is a $\Lawv$-module morphism. 

Finally, for any family $h_{i}:M\otimes N\to R$, we have 
$(\bigvee_{i}h_{i})_{x}(y)=\bigvee_{i}h_{i}(x\otimes y)=\bigvee_{i}(h_{i})_{x}(y)=(\bigvee_{i}h_{i})(x\otimes y)$, and thus we have a sup-lattice homomorphism $\zeta$ from $\Mod(M\otimes N,R)$ to $\Mod(M,\Mod(N,R))$ given by $\zeta(h)=h_{\_}$.

Let us show that $\zeta$ has an inverse:  for all $f\in \Mod(M,\Mod(N,R))$, define $f': M\times N\to R$ by $f'(x,y):=f(x)(y)$. This is clearly a bimorphism, so there is a unique homomorphism $h_{f'}:M\otimes N\to M\times N$ such that $f'=h_{f'}\circ \tau$, i.e.~such that 
$h_{f'}(x\otimes y)=f'(x,y)=f(x)(y)$, and thus $\zeta(h_{f'})=f$.
On the other hand, if $f=\zeta(h)$, then the uniqueness of $h_{f'}$ ensures that $h_{f'}=h$.
\end{proof}





\begin{proposition}
\begin{itemize}
\item[i.] $\Mod(Q,M)\simeq M$.
\item[ii.] $\Mod(M,N)\simeq \Mod(N^{\mathrm{op}},M^{\mathrm{op}})$.
\item[iii.] $\Mod(M, \Lawv^{\mathrm{op}})\simeq M^{\mathrm{op}}$.
\end{itemize}
(all isomorphisms of sup-lattices).
\end{proposition}
\begin{proof}
Define $\alpha:M\to \Mod(Q,M)$ by $\alpha(x)(\epsilon)=x\star\epsilon$ and 
$\beta:\Mod(Q,M)\to M$ by $\beta(f)=f(0)$. Then we have that 
$\alpha(\beta(f))(\epsilon)=\alpha(f(0))(\epsilon)=f(0)\star\epsilon=f(\epsilon)$, and 
$\beta(\alpha(x))=\beta(\lambda \epsilon.x\star\epsilon)=x\star0=x$.

If $f\in \Mod(M,N)$, since it preserves joins, it has a right-adjoint $f^{*}:N^{\mathrm{op}}\to M^{\mathrm{op}}$, such that $f(x)\leq y$ iff $x\leq f^{*}(y)$. 


By i.~$\Mod(Q,M^{\mathrm{op}})\simeq M^{\mathrm{op}}$ and we conclude by ii.
\end{proof}

\begin{proposition}
\begin{itemize}
\item[i.] $\Mod(M,N)\simeq (M\otimes N^{\mathrm{op}})^{\mathrm{op}}$.
\item[ii.] $M\otimes N\simeq \Mod(M, N^{\mathrm{op}})^{\mathrm{op}}$.
\item[iii.] $Q\otimes  M \simeq M\otimes Q\simeq Q$.
\end{itemize}
\end{proposition}
\begin{proof}
$\Mod(M,N)\simeq \Mod(M, \Mod(N^{\mathrm{op}},\Lawv^{\mathrm{op}}))
\simeq \Mod(M\otimes N^{\mathrm{op}},\Lawv^{\mathrm{op}})\simeq
(M\otimes N^{\mathrm{op}})^{\mathrm{op}}$.
Claim ii.~is proved similarly.

For claim iii.~$Q\otimes M\simeq M\otimes M\simeq \Mod(M, \Lawv^{\mathrm{op}})^{\mathrm{op}}\simeq (M^{\mathrm{op}})^{\mathrm{op}}=M$. 
\end{proof}


By putting all previous results together we obtain:
\begin{theorem}
$\Mod$ is a $^{*}$-autonomous category.
\end{theorem}


Further useful properties are the following:


\begin{proposition}\label{prop:Qtensor}[cf.~\cite{Russo2007}]
\begin{itemize}
\item[i.] $\Lawv^{X}\otimes M \simeq M^{X}$;
\item[ii.] $\Lawv^{X}\otimes \Lawv^{Y}\simeq \Lawv^{X\times Y}$.
\end{itemize}
\end{proposition}
\begin{proof}
$M^{X}$ coincides with the product $\Pi_{x\in X}M$. We have then 
$\Lawv^{X}\otimes M \simeq (\Pi_{x}Q)\otimes M \simeq \Pi_{x}(Q\otimes M) \simeq \Pi_{x}M\simeq M^{X}$.

For ii., using i.~we have $\Lawv^{X}\otimes \Lawv^{Y}\simeq( \Lawv^{Y})^{X}\simeq \Lawv^{X\times Y}$.
\end{proof}


$\Mod$ admits biproducts, since products and coproducts exist in $\Mod$ and both coincide with the order product:
$$
\prod_{i\in I}X_{i} \simeq \coprod_{i\in I}X_{i}
$$
In particular, the projection and
 injection morphisms $\pi_{i}:\prod_{i}X_{i}\to X_{i}$ and $\iota_{i}:X_{i} \to \prod_{i\in I}X_{i}$ are defined by 
$$
\pi_{i}\big( (x_{j})_{j\in I}\big) = x_{i} \qquad \qquad
\iota_{i}(x)({j})= \begin{cases} x & \text{ if }i=j\\ \bot & \text{ otherwise}\end{cases}
$$
Moreover, biproducts commute with tensors as follows:
\begin{proposition}\label{prop:productvstensor}[cf.~\cite{Russo2007}]
$\prod_{i\in I} X\otimes Y_{i} \simeq X \otimes \prod_{i\in I}Y_{i}$.
\end{proposition}
\begin{proof}[Proof sketch]
We just recall the isomorphism 
$h: \prod_{i\in I} X\otimes Y_{i} \simeq X \otimes \prod_{i\in I}Y_{i}$, defined as follows:
\begin{align*}
h\Big( i\mapsto \bigvee_{k\in J_{i}}x_{i,k}\otimes y_{i,k}\Big ) = 
\bigvee_{i\in I,k\in J_{i}}x_{i,k} \otimes \iota_{i}\big( (y_{j,k})_{j\in I}\big)
\end{align*}
and its inverse
\begin{align*}
k\Big( \bigvee_{k\in J}x_{k}\otimes \big(x_{k,i}\big)_{i\in I_{k}}\Big)(i)=
\bigvee_{k\in J,i\in I_{k}}x_{k}\otimes \pi_{i}\big((x_{k,j})_{j\in I_{k}}\big).
\end{align*}
\end{proof}



\subsubsection{The Tensor Product of $\Lawv$-Categories}



Thanks to Theorem \ref{thm:equivalence}, the $^{*}$-autonomous structure of $\Mod$ translates into a $^{*}$-autonomous structure for $\GMet$.

In $\mathsf{Met}$ the ``tensor product'' of two metric spaces $X$ and $Y$ is just their cartesian product, with the ``plus'' metric. What can we say about the tensor product in $\GMet$?

% 
%Let us start by discussing the construction of the tensor product $M\otimes N$ of $\Lawv$-modules $M$ and $N$ as a quotient of $\C P(M\times N)$. First, $\C P(M\times N)$ is the \emph{free} sup-lattice over $M\times N$: this means that any morphism 
%$f: M\times N \to L$, where $L$ is a sup-lattice, uniquely extends into a sup-lattice morphism $f^{*}:\C P(M\times N)\to L$, given by $f^{*}(A)=\bigvee_{x\in A}f(x)$. 
%
%
%\begin{lemma}
%For all $m\in M$ and $n\in N$, 
%\begin{align*}
%m\otimes n= &  \{A \mid \bigvee A= (m',n'+\epsilon+\delta), m=m'+\epsilon, n=n'+\delta\}\\
%& \cup
% \{A \mid \bigvee A= (m'+\epsilon+\delta, n'), m=m'+\epsilon, n=n'+\delta\}\end{align*}
%\end{lemma}
%\begin{proof}
%
%
%\end{proof}
The goal of this subsection is to describe the $\Lawv$-categorical structure of the tensor product explicitly. The main intuition is that the elements of $X\otimes Y$ can be seen as joins of pairs $x\otimes y$ of elements $x\in X$, $y\in Y$. We will then show that the metric coincides with the ``plus'' metric over pairs $x\otimes y$, and extends continuously to joins. 


\begin{lemma}\label{lemma:tensorsum}
For all $m,m'\in M$ and $n,n'\in N$ and $\epsilon \in Q$, 
$(m\otimes n)\star \epsilon \succeq (m'\otimes n')$ iff there exists $\delta_{1},\delta_{2}$ such that $\delta_{1}+\delta_{2}=\epsilon$, 
$m+\delta_{1}\succeq m'$ and $n+\delta_{2}\succeq n'$.
\end{lemma}
\begin{proof}[Proof Sketch]
Notice that $(m\otimes n)\star \epsilon = [\{(m\star \epsilon,n)\}]=
[\{(m\star \delta_{1},n\star \delta_{2}\}]$ for all $\delta_{1}+\delta_{2}=\epsilon$. 
Hence, $m'\otimes n' \preceq (m\otimes n)\star \epsilon$ implies that 
for some $\delta_{1}+\delta_{2}=\epsilon$, 
$(m',n')\vee (m\star\delta_{1},n\star\delta_{2}) = (m'\vee (m\star\delta_{1}), n'\vee (n\star\delta_{2}))= (m\star \delta_{1}, n'\star\delta_{2})$, that is, that $m'\preceq_{M} m\star \delta_{1}$ and $n'\preceq_{n}n\star \delta_{2}$. 
\end{proof}


\begin{proposition}\label{prop:tensormetric}
For all $m,m'\in N$ and $n,n'\in N$, 
$$
(M\otimes  N)(m\otimes  n, m'\otimes n')= M(m,m') +N(n,n')
$$
More generally, 
$$
(M\otimes N)([A],[B])= \sup_{(x,y)\in A}\inf_{(x',y')\in B}M(x,x')+N(y,y')
$$
\end{proposition}
\begin{proof}
By definition, $(M\otimes  N)(m\otimes  n, m'\otimes n')$ is given by $\inf A$, where
$$
A=\{ \epsilon \mid (m\otimes n)\star\epsilon \geq m'\otimes n'\}
$$
Let us show that $A$ coincides with 
$$
B=\{ \delta_{1}+\delta_{2} \mid m\star\delta_{1} \geq  m', n\star \delta_{2}\geq n'\}$$
On the one hand, if $\delta_{1}+\delta_{2}\in B$, it is clear that $\delta_{1}+\delta_{2}\in A$. Conversely, if $\epsilon\in A$, then by Lemma \ref{lemma:tensorsum} $\epsilon=\delta_{1}+\delta_{2}$ with $m\star\delta_{1}\geq m'$ and $n\star \delta_{2}\geq n'$, whence 
$\epsilon \in B$. 

We can now conclude as follows:
\begin{align*}
(M\otimes  N)(m\otimes  n, m'\otimes n')& =\inf A \\
&= \inf B \\
&= \inf \{ \delta_{1} \mid m\star\delta_{1} \geq  m'\}
+ \inf\{ \delta_{2} \mid  n\star \delta_{2}\geq n'\}\\
&= M(m,m')+N(n,n').
\end{align*}


For the second claim, using the fact that $M\otimes N$, as a $\Lawv$-category, is both tensored and cotensored, using the fact that 
$[A]=\bigvee_{(x,y)\in A}x\otimes y$ and $[B]=\bigvee_{(x',y')\in B}z\otimes w$, and Lemma \ref{lemma:supinf}:
\begin{align*}
(M\otimes  N)([A],[B])&=
\sup_{(x,y)\in A}(M\otimes N)(x\otimes y, [B]) \\
&=\sup_{(x,y)\in A}\inf_{(x',y')\in B}(M\otimes N)(x\otimes y, x'\otimes y') 
\\
&=
\sup_{(x,y)\in A} \inf_{(x',y')\in B}M(x,x')+N(y,y').
\end{align*}
\end{proof}


\subsection{Exponential and Differential Structure of $\Mod$}

\subsubsection{Symmetric Algebras in $\Mod$ }

Given $\Lawv$-multisets $A$ and $B$, we define the multiset $A\cup B$ as follows:
\begin{itemize}
\item if $A=0$, then $A\cup B=B$;
\item if $B=0$, then $A\cup B=A$;
\item if $A=[x_{1},\dots, x_{n}]$ and $B=[y_{1},\dots, y_{m}]$, then $A\cup B=[x_{1},\dots, x_{n},y_{1},\dots, y_{m}]$.


\end{itemize}

\begin{proposition}
Let $X$ be a $\Lawv$-module and $n\in \BB N$. Any $\Lawv$-multiset $[x_{1},\dots, x_{n}]\in X^{\otimes_{n}}$ is p-invariant. Moreover, any p-invariant element $x\in X^{\otimes_{n}}$ can be written as 
a join of $\Lawv$-multisets.
\end{proposition}
\begin{proof}
For the first claim we have, for all $\sigma\in \F S_{n}$, 
\begin{align*}
\langle \sigma \rangle ([x_{1},\dots, x_{n}]) & = 
\bigvee_{\tau\in \F S_{n}}\langle \sigma \rangle ([x_{\tau(1)},\dots, x_{\tau(n)}])\\
 & = 
\bigvee_{\tau\in \F S_{n}}[x_{\sigma\tau(1)},\dots, x_{\sigma\tau(n)}])\\
 & = 
\bigvee_{\tau\in \F S_{n}}[x_{\tau(1)},\dots, x_{\tau(n)}])\\
&= [x_{1},\dots, x_{n}].
\end{align*}
For the second claim, observe that $x$ can always be written as a join of tensors $x=\bigvee_{i}x_{1}^{i}\otimes \dots \otimes x_{n}^{i}$. Moreover, 
if $x_{1}^{i}\otimes \dots \otimes x_{n}^{i}\leq x$, since $x$ is p-invariant, for all $\sigma \in \F S_{n}$, also
$x_{\sigma(1)}^{i}\otimes \dots \otimes x_{n}^{i}\leq \langle \sigma\rangle(x)=x$, so we can conclude that 
$x=\bigvee_{i}[x_{1}^{i},\dots, x_{n}^{i}]$.
\end{proof}


\begin{proposition}
For any $\Lawv$-module $X$, the set $!_{n}X\subseteq X$ of p-invariant elements of $X^{\otimes_{n}}$ is a sub-$\Lawv$-module of $X$.
\end{proposition}
\begin{proof}
If $x_{i}\in X^{\otimes_{n}}$ is a family of p-invariant elements, then 
$x=\bigvee_{i}x_{i}$ is also p-invariant, since $\langle \sigma\rangle (x)=\bigvee_{i}\langle \sigma \rangle (x_{i})=\bigvee_{i}x_{i}=x$. Hence $!_{n}X$ is a sup-lattice.
Moreover, for all $x\in !_{n}X$ and $\epsilon \in Q$, 
$x\otimes \epsilon$ is also p-invariant, since $\langle \sigma \rangle (x\otimes \epsilon)= \langle \sigma \rangle (x)\otimes \epsilon=x\otimes \epsilon$. We conclude that $!_{n}X$ is a sup-lattice with a continuous action of $\Lawv$, where both the order and the action are inherited from $X$, so it is a sub-$\Lawv$-module of $X$.
\end{proof}


The fundamental property of $!_{n}X$ is the following:
\begin{proposition}
For any $\Lawv$-module $X$ and $n\in \BB N$, the inclusion morphism 
$\iota:!_{n}X\longrightarrow X^{\otimes_{n}}$ is the equalizer of the diagram
$$
\begin{tikzcd}
!_{n}X \ar{r}{\iota} & X^{\otimes_{n}} \ar{r}{\langle \sigma\rangle} & X^{\otimes_{n}}
\end{tikzcd}
$$
generated by all actions $\langle \sigma\rangle$, for $\sigma\in \F S_{n}$.
\end{proposition}
\begin{proof}
It is clear that $\langle \sigma \rangle \circ \iota= \langle \tau\rangle \circ \iota$ holds for all $\sigma, \tau \in \F S_{n}$.
Suppose now $h: C\to X^{\otimes_{n}}$ is another morphism satisfying
$\langle \sigma \rangle \circ h= \langle \tau\rangle \circ h$ for all $\sigma, \tau \in \F S_{n}$.
Since $\langle \sigma \rangle \circ h= \langle \mathrm{id}\rangle \circ h=h$, we deduce that $h(c)$ is p-invariant, for all $c\in C$. Hence $h$ splits in a unique way as $C \stackrel{h}{\to} !_{n}X \stackrel{\iota}{\to} X^{\otimes_{n}}$.
\end{proof}

\begin{remark}[metric structure of $!_{n}X$]
As $!_{n}X$ is a sub-$\Lawv$-module of $X^{\otimes_{n}}$, the distance function can be computed explicitly using Proposition \ref{prop:tensormetric}:
\begin{align*}
!_{n}X( [x_{1},\dots, x_{n}], [y_{1},\dots, y_{n}]) & = 
\sup_{\sigma\in \F S_{n}}\inf_{\tau\in \F S_{n}}
\sum_{i=1}^{n}
X(x_{\sigma(i)},y_{\tau(i)})
\end{align*}
\end{remark}


We now show that the $\Lawv$-module $!_{n}X$ is isomorphic to the symmetric algebra, which is used in the construction of the exponential modality in the relational model.

\begin{definition}[symmetric algebra]
For any $\Lawv$-module $X$ and $n\in \BB N$, we let $\mathrm{Sym}_{n}(X)$ indicate the $\Lawv$-module defined as 
$\mathrm{Sym}_{n}(X):=\frac{X^{\otimes_{n}}}{\sim_{n}}
$, where $\sim_{n}$ is the least congruence generated by the action $\langle \sigma\rangle$ of permutations $\sigma\in \F S_{n}$.\end{definition}

\begin{proposition}
$!_{n}X\simeq \mathrm{Sym}_{n}(X) $.
\end{proposition}
\begin{proof}
First, observe that for any equivalence class $\alpha\in \mathrm{Sym}_{n}(X)$, the point $\bigvee\alpha$ is p-invariant: 
 since $x\in \alpha$ holds iff $\langle \sigma \rangle (x)\in \alpha$, for all $\sigma\in\F S_{n}$, 
it follows that $\langle \sigma \rangle (\bigvee \alpha)=\bigvee\{\langle \sigma \rangle (x)\mid x\in \alpha\}=\bigvee \{x\mid x\in \alpha\}=\bigvee \alpha$, and thus $\bigvee\alpha$ is p-invariant.




Now, let us show that for all $x\in X^{\otimes_{n}}$, $x \sim_{n} \bigvee[x]$: for all $y\in [x]$, by definition $x\sim_{n}y$ holds; hence, since $\sim_{n}$ is a congruence, we have that 
$x=\bigvee_{y\in[x]}x \sim_{n} \bigvee_{y\in [x]}y=\bigvee[x]$.
Observe that this implies that $[\bigvee[x]]=[x]$.


Let us now show that for all p-invariant point $x_{0}$, and for all $y,z\in X^{\otimes_{n}}$, if 
$y\leq x_{0}$ and $z\sim y$ holds, then $z\leq x_{0}$.

We will exploit the fact that $\sim$ is the least congruence containing the relation $\sim_{0}$ induced by the action of permutations. More precisely, $\sim$ can be defined explicitly as 
$$
x\sim y  \ \Leftrightarrow \ \exists \alpha . \mathrm{OR}(\alpha) \land x\sim^{(\alpha)}y
$$
where $\mathrm{OR}(\alpha)$ is the property ``$\alpha$ is an ordinal'', and the relations $\sim^{(\alpha)}$ are defined by induction as follows:
\begin{itemize}
\item $x\sim^{(0)}y$ iff either $x\sim_{0}y$, $x=y$ or $y\sim_{0}x$ holds;
\item $x\sim^{(\alpha+1)}y$ iff one of the following holds:
	\begin{itemize}
	\item for some $z$, $x\sim^{(\alpha)}z$ and $z\sim^{(\alpha)}y$ holds;
	\item for some set $I$, and families $x_{i},y_{i}$, 
	$x=\bigvee x_{i}, y=\bigvee_{i}y_{i}$ and $x_{i} \sim^{(\alpha)}y_{i}$ holds for all $i\in I$.

	\end{itemize}
\item $x\sim^{(\gamma)}y$ iff $x\sim^{(\delta)}y$ holds for some $\delta <\gamma$, for $\gamma$ limit.
\end{itemize}

We will now prove, by induction on an ordinal $\alpha$, that for all p-invariant point $x_{0}$, and for all $y,z\in X^{\otimes_{n}}$, if 
$y\leq x_{0}$ and $z\sim^{(\alpha)} y$ holds, then $z\leq x_{0}$.
From this the claim will follow.

\begin{itemize}
\item if $z\sim^{0} y$, then either $z=y$, in which case the claim follows from the hypothesis, or $z=z_{1}\otimes \dots \otimes z_{n}$ and $y=y_{\sigma(1)}\otimes \dots \otimes y_{\sigma(n)}$; then from $y\leq x_{0}$ we deduce $z=\langle \sigma^{-1} \rangle(y)\leq \langle \sigma^{-1}\rangle(x_{0})=x_{0}$.

\item if $z\sim^{\alpha+1}y$ two possibilities arise:
	\begin{enumerate}
	\item if $z\sim^{\alpha}z'\sim^{\alpha}y$, then by IH we have $z'\leq x_{0}$, and again by IH applied to $z'$ we deduce $z\leq x_{0}$;
	\item $z=\bigvee_{i}z_{i}$ and $y=\bigvee_{i}y_{i}$, with $z_{i}\sim^{\alpha}y_{i}$, then from $y_{i}\leq y\leq x_{0}$, we deduce, by IH, $z_{i}\leq x_{0}$, and thus $z\leq x_{0}$.
	
	\end{enumerate}

\item if $z\sim^{\gamma}y$ for $\gamma$ limit, then $z\sim^{\beta}y$ for some $\beta<\gamma$, so by IH we deduce $z\leq x_{0}$.


\end{itemize}
From the argument above we now deduce that for all p-invariant point $x_{0}$, and for all $y,z\in X^{\otimes_{n}}$, if 
$y\leq x_{0}$ and 
$z\sim_{n}y$ holds, then $z\leq x_{0}$.
From this we can deduce in turn that for all $x\in X^{\otimes_{n}}$, $\bigvee[x]$ is the smallest p-invariant over $x$: suppose $x_{0}$ is a p-invariant point and $x\leq x_{0}$; then for all $y\in [x]$, we deduce $y\leq x_{0}$ by the argument above, and we can thus conclude that $\bigvee[x]\leq x_{0}$.

Let now $x$ be p-invariant; as $x$ is the smallest p-invariant over $x$, we deduce that $x= \bigvee[x]$.


Using the previous facts we can now define an isomorphism $h:!_{n}X\to  \mathrm{Sym}_{n}(X)$ by letting  $h(x)=[x]$, with inverse $k([x])=\bigvee [x]$. Indeed, we have that 
$k(h(x))=\bigvee[x]=x$, and 
$h(k([x]))=[\bigvee[x]]=[x]$.
%
%First, let us show that for all $x\in !_{n}X\subseteq X^{\otimes_{n}}$, the corresponding equivalence class in $\mathrm{Sym}_{n}(X)$ is a singleton, i.e.~$[x]=\{x\}$. 
%To prove this, let us first show that for all ordinals $\alpha$ and p-invariant $x$, if $x \sim_{n}^{(\alpha)}y$ then $x=y$, where $\sim_{n}^{(\alpha)}$ is defined as in Proposition \ref{prop:smallestcongruence}. 
%\begin{itemize}
%\item $x\sim_{n}^{(0)}y$ holds iff either $x=y$, $x\sim_{n}y$ or $y\sim_{n}x$; if $x\sim_{n}y$, then it must be $x=x_{1}\otimes \dots \otimes x_{n}$ and $y=\langle \sigma\rangle(x)$, but since $x$ is permutation-closed, $x=\langle \mathrm{id}\rangle(x)=\langle \sigma\rangle(x)=y$. 
%
%\item $x\sim_{n}^{(\alpha+1)}y$ holds iff either $x\sim_{n}^{(\alpha)}z$ and $z\sim_{n}^{(\alpha)}y$ both hold, or $x=\bigvee_{i}x_{i}$, $y=\bigvee_{i}y_{i}$ and $x_{i}\sim_{n}^{(\alpha)}y_{i}$ all hold.
%In the first case, by IH we have $x=z$, so $z$ is p-invariant, and by applying again the IH, also $y=z$ holds, and thus $x=y$; 
%in the second case, {\color{red}by IH we have $x_{i}=y_{i}$ for all index $i$, whence 
%$x=\bigvee_{i}x_{i}=\bigvee_{i}y_{i}=y$.}
%
%\item if $x\sim_{n}^{(\gamma)}y$ for $\gamma$ limit, then
%$x\sim_{n}^{(\beta)}y$ holds for some $\beta<\gamma$, so by IH, $x=y$.
%
%
%\end{itemize}
%Now, if $x\sim_{n}y$ holds, then $x\sim_{n}^{(\alpha)}y$ holds for some ordinal $\alpha$, whence $x=y$. 
%
%
%
%
%Now, the main claim follows from the existence of the following two morphisms:
%a morphism $h:!_{n}X\to \mathrm{Sym}_{n}(X)$ given by $h(x)=[x]=\{x\}$ and a morphism $k: \mathrm{Sym}_{n}(X)\to !_{n}X$ given by $k(\alpha)=\bigvee\alpha$. Then $k\circ h(x)=x$ while $h\circ k(\alpha)=[\bigvee \alpha]=\{\bigvee\alpha\}$, so $k$ and $h$ define an isomorphism between $!_{n}X$ and the $\sim$-classes of $\mathrm{Sym}_{n}(X)$.
\end{proof}


The following lemma shows the compatibility of the construction of $!_{n}X$ with the usual construction of the exponential modality in weighted relational models.
\begin{lemma}
For any set $S$, there exists an isomorphism of $\Lawv$-modules
$$!_{n}\Lawv^{S} \simeq \Lawv^{\C M_{n}(S)}$$
where $\C M_{n}(X)$ indicates the set of multisets of $X$ of cardinality $ n$.
\end{lemma}
\begin{proof}
Let us show that the morphism $h:\Lawv^{\C M_{n}(S)}\to \Lawv^{S\times \dots \times S}$ defined by 
$$
h(f)(\langle s_{1},\dots, s_{n}\rangle)=h([s_{1},\dots, s_{n}])
$$
is the equalizer of the diagram 
$$
\begin{tikzcd}
\Lawv^{\C M_{n}(S)} \ar{r}{h} &\Lawv^{S\times \dots \times S}\ar{r}{[\sigma]} &
\Lawv^{S\times \dots \times S}
\end{tikzcd}
$$
where $[\sigma](x)(\langle s_{1},\dots, s_{n}\rangle)=x(\langle x_{\sigma(1)},\dots, x_{\sigma(n)}\rangle)$, with $\sigma$ varying over $\F S_{n}$.

It is immediate that $h\circ [\sigma]=h\circ [\tau]$, for all $\sigma,\tau\in \F S_{n}$. Let now $k: C\to \Lawv^{S\times \dots \times S}$ satisfy $k\circ [\sigma]=k\circ [\tau]$: then for all $c\in C$, $k(c)(\langle s_{1},\dots, s_{n}\rangle)=k(c)(\langle s_{\sigma(1)},\dots, s_{\sigma(n)}\rangle)$, so $k(c)$ actually defines a unique element of $\Lawv^{\C M_{n}(S)}$, and thus $k$ splits in a unique way as $C \stackrel{k'}{\to} \Lawv^{\C M_{n}(S)} \stackrel{h}{\to}\Lawv^{S\times \dots \times S}$.


Now, to conclude it suffices to observe that, by Proposition \ref{prop:Qtensor}, 
$\Lawv^{S\times \dots \times S}\simeq (\Lawv^{S})^{\otimes_{n}}$, and then, since equalizers are unique up to a unique isomorphism, we obtain an isomorphism $\Lawv^{\C M_{n}(S)}\simeq !_{n}\Lawv^{S}$.
%
%We define morphisms $h: !_{n}\Lawv^{S}\to \Lawv^{\C M_{n}(S)}$ and 
%$k: \Lawv^{\C M_{n}(S)}\to !_{n}\Lawv^{S}$ given by 
%\begin{align*}
%h([x_{1},\dots, x_{n}])(\{a_{1},\dots, a_{n}\})&=
%\sup_{\sigma\in \F S_{n}}\sum_{i=1}^{n}
%x_{i}(a_{\sigma(i)})\\
%k(f)& = 
%\bigvee_{a_{1},\dots, a_{n}\in S}[\B Y(a_{1}),\dots, \B Y(a_{n})]+ f(\{a_{1},\dots, a_{n}\})
%\end{align*}
%
\end{proof}




\subsubsection{Linear Differential Categories}


There exist many equivalent way to describe linear differential structure over symmetric monoidal categories with biproducts. Here we chose the approach via bialgebra modalities (see \cite{Lemay2017, Blute2019}).


\begin{definition}[bialgebra modality]
Let $\BB C$ be an additive symmetric monoidal category. A \emph{bialgebra modality over $\BB C$} is a septuple $(!,\delta,\epsilon, \Delta, e,\nabla, u)$ consisting of:
\begin{enumerate}
\item a comonad $(!,\delta,\epsilon)$, that is, a functor $!$ together with natural transformations $\delta: !X\to !!X$ and $\epsilon:!X\to X$ satisfying
\begin{align}
\epsilon \circ \delta & = !\epsilon \circ \delta= 1 \\
!\delta \circ \delta  & = \delta\circ !\delta
\end{align}

\item two natural transformations $\Delta:!X\to !X\otimes !X$ and $e:!X\to \{\star\}$ such that $(!X, \Delta, e)$ is a cocommutative comonoid, that is the following equations hold:
\begin{align}
(\Delta \otimes  1)\circ \Delta & = ( 1\otimes \Delta )\circ \Delta \\
 ( 1\otimes e)\circ \Delta & = (e\otimes  1)\circ \Delta =1 \\
\sigma \circ\Delta& =  \Delta
\end{align}
and $\delta$ preserves the comultiplication, that is
\begin{align}
(\delta \otimes \delta)\circ \Delta = \Delta \circ \delta
\end{align}

\item two natural transformations $\nabla: !X\otimes !X \to !X$ and $u:\{\star\}\to !X$ such that $(!X,\nabla, u)$ is a commutative monoid, that is, the following equations hold:
\begin{align}
\nabla\circ (\nabla\otimes 1)  & = \nabla \circ (1\otimes \nabla) \\
 \nabla \circ(1\otimes u )& = \nabla \circ  (u\otimes 1) =1\\
\nabla\circ \sigma & = \nabla
\end{align}

\item $(!X,\nabla, u, \Delta, e)$ is a bialgebra, that is the following equations hold:
\begin{align}
e\circ\nabla  & =  e\otimes e\\
 \Delta \circ u& = u\otimes u \\
u\circ e & = 1\\
 \Delta \circ \nabla 
&=(\nabla\otimes \nabla)\circ (1\otimes \sigma\otimes 1)\circ (\Delta\otimes \Delta)
\end{align}

\item $\epsilon$ is compatible with $\nabla$, that is
\begin{align}
 \epsilon \circ \nabla& =  (\epsilon\otimes e)+(e\otimes \epsilon)
\end{align}

\end{enumerate}

\end{definition}


\begin{definition}[cf.~\cite{Lemay2017}]
A \emph{codereliction} for a bialgebra modality $(!,\delta,\epsilon,\Delta, e,\nabla,u)$ is a natural transformation $\eta:X\to !X$ satisfying the following equations:
\begin{align}
e\circ \eta & = 0\\
 \Delta\circ \eta&  = (\eta\otimes u)+(u\otimes \eta) \\
 \epsilon\circ \eta & = 1 \\
\delta \circ \nabla\circ(1\otimes \eta) & =  \nabla \circ 
 (\delta\otimes \eta) \circ  (1\otimes \nabla)\circ
(\Delta \otimes \eta)
\end{align}
\end{definition}


\begin{definition}
Let $\BB C$ be an additive (i.e.~monoid-enriched) symmetric monoidal category with biproducts.
 $\BB C$ is a \emph{monoidal storage category} if it has a coalgebra modality satisfying the \emph{Seely isomorphisms}, that is, the maps
 $e:!\top \to \{\star\}$ and $\chi:!(X\times Y) \to !X\otimes !Y$, with $\chi=\Delta \circ  !(\pi_{0})\otimes!(\pi_{1})$, are isomorphisms (whence $!\top\simeq \{\star\}$ and $!(X\times Y)\simeq !X\otimes !Y$).
\end{definition}


\begin{definition}
Let $\BB C$ be an additive symmetric monoidal category. A bialgebra modality $(!,\delta,\epsilon,\Delta,e,\nabla,u)$ on $\BB C$ is \emph{additive} if the following equations hold:
\begin{align}
\nabla\circ (!f\otimes !g)\otimes \Delta  & = !(f+g)\\ 
u\circ e & = !0
\end{align}
\end{definition}

We use the following result:
\begin{theorem}[cf.~\cite{Lemay2017}]\label{theorem:lemay}
Every additive symmetric monoidal category with an additive bialgebra modality and finite products satisfies the Seely isomorphisms.
\end{theorem}


\begin{definition}
A \emph{linear differential category} is an additive symmetric monoidal category $\BB C$ with biproducts and a bialgebra modality with a codereliction and the Seely isomorphisms.
\end{definition}


\begin{theorem}
For any linear differential category $\BB C$, the co-Kleisli category $\BB C_{!}$ is a cartesian closed differential category, with deriving transformation $Df$ defined as follows:
$$
\begin{tikzcd}
!(X\times X)\  \simeq\  !X\otimes !X 
\ar{r}{1\otimes \epsilon}  & !X\otimes X \ar{r}{1\otimes \eta}&
!X\otimes !X \ar{r}{\nabla}& !X \ar{r}{f} & Y
\end{tikzcd}
$$
\end{theorem}


\subsubsection{The Free Exponential Modality of $\Mod$}


Using the recipe from \cite{Mellies2018}, together with Proposition \ref{prop:productvstensor}, the free exponential modality of $\Mod$ can be defined as
$$
! X:= \prod_{n\in \BB N}!_{n}X
$$
The functorial action of $!$ is defined, for a morphism $f: X\to Y$, as follows:
\begin{align*}
!f(g)(0) & = g(0) \\
!f (g)(n+1)   & = \bigvee\Big \{
[f(x_{1}),\dots, f(x_{n+1})] \mid [x_{1}, \dots, x_{n+1}]\leq g(n+1)\Big \}
\end{align*}

%where $g(n)=\bigvee_{i}
%[x_{1}, \dots, x_{n}]$.



The bialgebra modality $(!, \delta, \epsilon, \Delta, e, \nabla,u)$ is defined as follows:
\begin{itemize}
\item the comonad $(!,\delta,\epsilon)$ is given by:
{\small
\begin{align*}
\epsilon(f)& =  f(1) \\
%\OV{\mathrm{der}}& = \iota_{1}\\
\delta(f)(n) & = \bigvee\left\{ 
\iota_{n}([\iota_{i_{1}}(a_{1}), \dots , \iota_{i_{n}}(a_{n})]) \ \Big \vert \ 
a_{j}\in !_{i_{j}}X,  
a_{1}\cup \dots \cup a_{n}\leq f(i_{1}+\dots+ i_{n})
\right\}
\end{align*}
}

We have $\epsilon(\delta(\alpha))=\delta(\alpha)(1)=
\bigvee\{\iota_{n}(\alpha(n))\mid n\in \BB N\}=\alpha$, and 
{\small
\begin{align*}
!\epsilon(\delta(\alpha))(n)&=
\bigvee\{ [\epsilon(\alpha_{1}),\dots, \epsilon(\alpha_{n})]
\mid
[\alpha_{1},\dots, \alpha_{n}] \leq \delta(\alpha)(n)\}
 \\
 &=
 \bigvee\left \{ [\epsilon(\alpha_{1}),\dots, \epsilon(\alpha_{n})]
\ \Bigg \vert \ 
\alpha_{i}=\iota_{j_{i}}(a_{i}),\bigcup_{i}a_{i}\leq 
%
%[ \iota_{j_{1}^{i}}(a_{1}^{i}),\dots, \iota_{j_{s_{i}}^{i}}(a_{s_{i}}^{i})], 
%\left [\bigcup_{j}a_{j}^{1},\dots, \bigcup_{j}a_{j}^{n}\right] \leq 
\alpha(n)
\right \} \\
&=
 \bigvee\left \{ [\epsilon(\alpha_{1}),\dots, \epsilon(\alpha_{n})]
\ \Bigg \vert \ 
\alpha_{i}=\iota_{1}(x_{i}),[x_{1},\dots, x_{n}]\leq 
\alpha(n)
\right \} \\
&= \bigvee\left \{ [
x_{1},\dots, x_{n}] \ \Bigg \vert  \ 
[x_{1},\dots, x_{n}]\leq \alpha(n)
\right \} = \alpha(n)
 \end{align*}
 }
%But since $\epsilon(\beta)=\beta(1)$, this means that we are reduced to consider multisets $\alpha_{j}^{i} $ of cardinality 1, i.e.~of the form $[a_{j}^{i}]$, so we have  
% $!\epsilon(\delta(\alpha))(n)=
%\bigvee\{ [a_{1}^{i},\dots, a_{n}^{i}]\mid \bigvee_{i}[a_{1}^{i},\dots, a_{n}^{i}]= \alpha(n)\}= \alpha(n)$.


Let us now compute $!\delta(\delta (\alpha))$: 
{\small
\begin{align*}
!\delta(\delta(\alpha))(n)&=\bigvee_{i}\left \{[\delta(A_{1}),\dots, \delta(A_{n})]\ \Bigg\vert \   [A_{1},\dots, A_{n}]\leq \delta(\alpha)(n)\right\}\\
&=\bigvee\left \{[\delta(\iota_{m_{1}}(a_{1})),\dots, \delta(\iota_{m_{n}}(a_{n}))]\ \Bigg\vert \  
a_{j}\in !_{m_{j}}X, 
\bigcup_{j=1}^{n}a_{j}\leq \alpha(\sum_{l=1}^{n}m_{l})
\right\}\\
&= \bigvee \left\{
[ B_{1},\dots, B_{n}] \ \Bigg \vert \ 
B_{i}=\iota_{\sum_{j}r_{j}^{i}}\big([\iota_{r_{1}^{i}}(b_{1}^{i}),\dots, \iota_{r_{s_{i}}^{i}}(b_{m_{i}}^{i})]\big),\sum_{j}r_{j}^{i}=m_{i}, 
\left [\bigcup_{j}b_{j}^{1},\dots, \bigcup_{j}b_{j}^{n}\right ]\leq \alpha(\sum_{i}m_{i})
\right \}
\end{align*}
}


Let us compute $\delta(\delta(\alpha))$:
{\small
\begin{align*}
\delta(\delta(\alpha))(n) & = 
\bigvee\left \{
[\iota_{i_{1}}(A_{1}),\dots, \iota_{i_{n}}(A_{n})] \ \Bigg \vert \ 
A_{j}\in !_{i_{j}}X, \bigcup_{j}A_{j} \leq \delta(\alpha)(\sum_{j}i_{j})
\right\}\\
&=
\bigvee\left \{
[\iota_{i_{1}}(A_{1}),\dots, \iota_{i_{n}}(A_{n})] \ \Bigg \vert \ 
A_{j}= [\iota_{r_{1}^{j}}(b_{1}^{j}),\dots, \iota_{r_{s_{j}}^{j}}(b_{i_{j}}^{j})], 
\sum_{l} r_{l}^{j} = i_{j}, \left [\bigcup_{l}b_{l}^{1},\dots, \bigcup_{l}b_{l}^{n}\right ]\leq  \alpha(\sum_{j}i_{j})
\right\}
\end{align*}
}

From the two computations it is clear that $!\delta(\delta(\alpha)=\delta(\delta(\alpha))$. 

\item the cocommutative comonoid structure $(!X, \Delta, e)$ is  defined as follows:
{\small
\begin{align*}
\Delta(f)& = \bigvee
\left\{ \iota_{n}(a)\otimes \iota_{m}(b) \ \Big \vert \  
n,m\in \BB N, a\cup b\leq f(n+m)
\right\}\\
e(f)&= f(0)
\end{align*}
}

Let us check the relevant equations:

{\small
\begin{align*}
(\Delta\otimes 1)\Big(\Delta(\alpha)\Big)&=
(\Delta\otimes 1)\left (\bigvee\left \{\iota_{n}(a)\otimes \iota_{m}(b)\ \Big \vert \ a\cup b \leq \alpha(n+m)\right\}\right)\\
&= 
\bigvee\left \{\iota_{n_{1}}(a_{1})\otimes \iota_{n_{2}}(a_{2})\otimes \iota_{m}(b)\ \Big \vert \ a_{1}\cup a_{2}\cup b \leq \alpha(n_{1}+n_{2}+m)\right\}\\
&= 
\bigvee\left \{\iota_{n}(a)\otimes \iota_{m_{1}}(b_{1})\otimes \iota_{m_{2}}(b_{2})\ \Big \vert \ a\cup b_{1}\cup b_{2} \leq \alpha(n+m_{1}+m_{2})\right\}
\\
&= (1\otimes \Delta)\Big(\Delta(\alpha)\Big)
\end{align*}
}

{\small
\begin{align*}
(e\otimes 1)\Big(\Delta(\alpha)\Big) & = 
( e\otimes 1)\left (\bigvee\left \{\iota_{n}(a)\otimes \iota_{m}(b)\ \Big \vert \ a\cup b \leq \alpha(n+m)\right\}\right)\\
&= 
\bigvee\left \{\iota_{m}(b)\ \Big \vert \ b \leq \alpha(m)\right\} =
\alpha
\end{align*}
}
and one can argue similarly for $(1\otimes e)(\Delta(\alpha))$.

{\small
\begin{align*}
\sigma(\Delta(\alpha)) & = 
\bigvee\left \{\iota_{m}(b)\otimes \iota_{n}(a)\ \Big \vert \ a\cup b \leq \alpha(n+m)\right\}
\\
& = 
\bigvee\left \{\iota_{n}(a)\otimes \iota_{m}(b)\ \Big \vert \ a\cup b \leq \alpha(n+m)\right\}
\\&= \Delta(\alpha)
\end{align*}
}

Finally, the commutation of $\Delta$ and $\delta$:
{\small
\begin{align*}
(\delta\otimes \delta)\Big(\Delta(\alpha)\Big) & =
(\delta\otimes\delta)\left(\bigvee
\left\{
\iota_{n}(a)\otimes \iota_{m}(b) \mid a\cup b \leq \alpha(n+m)
\right\}\right)\\
&=
\bigvee
\left \{\iota_{k_{1}}(
[\iota_{i_{1}}(a_{1}),\dots, \iota_{i_{k_{1}}}(a_{k_{1}})])\otimes
\iota_{k_{2}}(
[\iota_{j_{1}}(b_{1}),\dots, \iota_{j_{k_{2}}}(b_{k_{2}})]) \ \Bigg \vert \
\bigcup_{l}a_{l} \cup \bigcup_{l}b_{l} \leq \alpha\left (\sum_{l}i_{l}+\sum_{l}j_{l}\right)
\right\}
\\
&=
\Delta
\left(\bigvee\left \{
\iota_{n}(
[\iota_{i_{1}}(a_{1}),\dots, \iota_{i_{n}}(a_{n})]) \ \Bigg \vert \ 
\bigcup_{j}a_{j}\leq \alpha(\sum_{j}i_{j})
\right\}\right)
\\
& = \Delta(\delta(\alpha))
\end{align*}
}

\item the commutative monoid structure $(!X,\nabla,u)$ is given by 
\begin{align*}
\nabla( f \otimes g) (n)& = \bigvee_{k+h=n}f(k)\cup g(h) \\ 
u & =  \iota_{0}
\end{align*}
Observe that $\nabla(f\otimes g)=\bigvee_{n,k+h=n}\iota_{n}(f(k)\cup g(h))$.

Let us check the relevant equations:

{\small
\begin{align*}
\nabla\left((\nabla\otimes 1)\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\otimes \gamma_{k}\right)\right) & =
\nabla \left(
\bigvee_{k,n}
\iota_{n}\left( \bigvee_{u+v=n}\alpha_{k}(u)\cup \beta_{k}(v)
\right)
\otimes \gamma_{k}
\right)\\
&=
\bigvee_{k,n}\iota_{n}\left( \bigvee_{u+v+w=n}
\alpha_{k}(u)\cup \beta_{k}(v)\cup \gamma_{k}(w)\right) \\
& =
\nabla \left(
\bigvee_{n,k}\alpha_{k}\otimes 
\iota_{n}\left( \bigvee_{v+w=n}\beta_{k}(v)\cup \gamma_{k}(w)\right)
\right)\\
&= 
\nabla\left((1\otimes\nabla)\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\otimes \gamma_{k}\right)\right) 
\end{align*}
}

{\small
\begin{align*}
\nabla\left(
(1\otimes u)\left(\bigvee_{k}\alpha_{k}\otimes 0\right)\right) & =
\nabla\left( \bigvee_{k}\alpha_{k}\otimes\iota_{0}(\epsilon)\right)
=
\bigvee_{n,k}\iota_{n}( \alpha_{k}(n) )
 =  \bigvee_{k}\alpha_{k} \otimes 0
\end{align*}
}
and one can argue similarly for $\nabla(u\otimes 1)(\alpha)=\alpha$.

{\small
\begin{align*}
\nabla\left (\sigma\left (\bigvee_{k}\alpha_{k}\otimes \beta_{k}
\right) \right) & = 
\nabla \left (
\bigvee_{k}\beta_{k}\otimes \alpha_{k}
\right)\\
&= 
\bigvee_{k,n, p+q=n} \iota_{n}(\beta_{k}(p)\cup \alpha_{k}(q))
\\
&= 
\bigvee_{k,n, p+q=n}\iota_{n}( \alpha_{k}(p)\cup \beta_{k}(q))
\\
&= \nabla\left (\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right)
\end{align*}
}

Let us check the bialgebra equations:

{\small
\begin{align*}
e\left (\nabla\left (\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right)\right)  & =
e\left(
\bigvee_{k,n, p+q=n}\iota_{n}(\alpha_{k}(p)\cup \beta_{k}(q))
\right)
\\
&= \bigvee_{k}\alpha_{k}(0)\cup\beta_{k}(0) \\
&= \bigvee_{k} 0\cup 0\\
&= h\left(\bigvee_{k}\alpha_{k}(0)\otimes\beta_{k}(0))\right) = h\left( (e\otimes e)\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right)\right)
\end{align*}
}
where $h:\Lawv\otimes\Lawv\to \Lawv$ indicates the isomorphism $h(\epsilon\otimes \delta)=\epsilon+\delta$.

{\small
\begin{align*}
\Delta(u(\epsilon))) = \Delta(\iota_{0}(\epsilon)) &=
 \left(
\bigvee\left\{\iota_{m}(a)\otimes\iota_{n}(b) \ \Bigg \vert \ 
a\cup b \leq \iota_{0}(\epsilon)(n+m)\right\}\right)\\
&=\bigvee\left\{\iota_{0}(\epsilon_{1})\otimes\iota_{0}(\epsilon_{2}) \ \Bigg \vert \ 
\epsilon_{1}+\epsilon_{2} \leq \epsilon\right\}\\
&= (u\otimes u)(\epsilon)
\end{align*}
}
where we are identifying $\epsilon \in q$ with the equivalence class
$\epsilon \otimes 0 = \{ \langle \epsilon_{1},\epsilon_{2}\rangle\mid \epsilon_{1}+\epsilon_{2}=\epsilon\}\in 
\Lawv\otimes\Lawv$ via the isomorphism $h$ described above.

\begin{align*}
e(u(\epsilon))&= \iota_{0}(\epsilon)(0)= \epsilon
\end{align*}




{\small
\begin{align*}
&(\nabla\otimes \nabla)  (1\otimes \sigma\otimes 1)(\Delta\otimes \Delta)\left (\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right) \\
&=
(\nabla\otimes \nabla)(1\otimes \sigma\otimes 1)
\left(
\bigvee
\left\{
 \iota_{n}(a_{1})\otimes \iota_{m}(a_{2})\mid
a_{1}\cup a_{2}\leq \alpha_{k}(n+m)
\right\}\otimes
\left\{
 \iota_{n}(b_{1})\otimes \iota_{m}(b_{2})\mid
b_{1}\cup b_{2}\leq \beta_{k}(n+m)
\right\}
\right)\\
&=
(\nabla\otimes \nabla)(1\otimes \sigma\otimes 1)
\left(
\bigvee
\left\{
 \iota_{n}(a_{1})\otimes \iota_{m}(a_{2})
\otimes \iota_{n'}(b_{1})\otimes \iota_{m'}(b_{2})
\mid
a_{1}\cup a_{2}\leq \alpha_{k}(n+m),
b_{1}\cup b_{2}\leq \beta_{k}(n'+m')
\right\}
\right)\\
&=
(\nabla\otimes \nabla)\left(
\bigvee
\left\{
 \iota_{n}(a_{1})\otimes \iota_{n'}(b_{1})
\otimes \iota_{m}(a_{2})\otimes \iota_{m'}(b_{2})
\mid
a_{1}\cup a_{2}\leq \alpha_{k}(n+m),
b_{1}\cup b_{2}\leq \beta_{k}(n'+m')
\right\}
\right)\\
&=
\bigvee_{k,z,z'}\left\{
\left(
\iota_{z}\left( \bigvee_{p+q=z}
a_{1}\cup b_{1}\right)\right)\otimes
\left(\iota_{z'}\left( \bigvee_{p'+q'=z'}
a_{2}\cup b_{2}\right)\right)
\ \Bigg \vert \
a_{1}\cup a_{2} \leq \alpha_{k}(p+p'),
b_{1}\cup b_{2}\leq \beta_{k}(q+q')
\right\}
\\
&=\Delta\left(
\bigvee_{k,z}
\left\{
\iota_{z}\left( \bigvee_{p+q=z} \alpha_{k}(p)\cup \beta_{k}(q) \right)
\right\}
\right)
\\
&=
\Delta\left (\nabla\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right) \right)
\end{align*}
}

Finally, let us check the compatibility of $\epsilon$ and $\nabla$, which in $\Mod$ reads as
$ \epsilon\circ \nabla=(\epsilon \otimes e)\vee (e\otimes \epsilon)$:
{\small\begin{align*}
\epsilon \left(\nabla\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right)\right) & =
\epsilon\left (  \bigvee_{k,n,p+q=n}\iota_{n}(\alpha_{k}(p)\cup \beta_{k}(q))\right) \\
&=\left(\bigvee_{k}\alpha_{k}(1) \right) \vee \left(
\bigvee_{k}\beta_{k}(1)\right)
\\
&=
\left( (\epsilon\otimes e)\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right)
\right)
\vee
\left( (e\otimes \epsilon)\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right)
\right)
\\
&=
\Big((\epsilon\otimes e)\vee (e\otimes \epsilon)\Big)\left(\bigvee_{k}\alpha_{k}\otimes \beta_{k}\right)
 \end{align*}
}


\item the codereliction $\eta: X\to !X$ is defined by 
$\eta= \iota_{1}$.

Let us check the codereliction equations:
\begin{align*}
e(\eta(x)) & = \iota_{1}(x)(0)=0
\end{align*}
\begin{align*}
\Delta(\eta(x)) & = \Delta(\iota_{1}(x)) \\
&=
\bigvee\left\{\iota_{1}(x)\otimes \iota_{0}(r) \mid r\in Q\right\}\vee
\bigvee\left\{\iota_{0}(r)\otimes \iota_{1}(x) \mid r\in Q\right\}
\\
&=
(\iota_{1}(x)\otimes 0 )\vee
(0\otimes \iota_{1}(x) )
\\
&=
(\eta\otimes u)(x)\vee(u\otimes \eta) (x) \\
&=
\Big(\eta\otimes u)\vee(u\otimes \eta)\Big) (x) 
\end{align*}

\begin{align*}
\epsilon(\eta(x))&= \iota_{1}(x)(1) =x
\end{align*}

For the last equation, we only check it on basic tensors:
{\small
\begin{align*}
& \nabla((\delta\otimes \eta)((1\otimes \nabla))(\Delta\otimes \eta)(\alpha\otimes x)) \\
&=\nabla((\delta\otimes \eta)((1\otimes \nabla))\left(
\bigvee
\{\iota_{n}(a)\otimes \iota_{m}(b)\otimes \iota_{1}(x)\mid a\cup b \leq \alpha(n+m)\}
\right)\\ 
&=\nabla\left ((\delta\otimes \eta)\left(
\bigvee
\{\iota_{n}(a)\otimes \iota_{m+1}(b\cup \{x\})\mid a\cup b \leq \alpha(n+m)\}\right)\right)
\\ 
&=\nabla\left (
\bigvee\left 
\{[\iota_{i_{1}}(c_{1}),\dots,\iota_{i_{r}}(c_{r})]
\otimes \iota_{1}( \iota_{m+1}(b\cup \{x\}))\ \Bigg \vert \ 
\bigcup_{j}c_{j}\cup b \leq \alpha\left (\sum_{j}i_{j}+m\right )\right\}\right)
\\ 
&=
\bigvee\left\{
[\iota_{i_{1}}(c_{1}),\dots,\iota_{i_{r}}(c_{r}), \iota_{m+1}(b\cup \{x\})] \ \Bigg \vert \
\bigcup_{j}c_{j}\cup b \leq \alpha\left (\sum_{j}i_{j}+m\right )\right\}
\\
&=
\delta\left(
\bigvee_{n}\iota_{n+1}(
\alpha(n)\cup \{x\})
\right)
\\
&=
\delta(\nabla(\alpha\otimes \iota_{1}(x))
\\
&=
\delta(\nabla((1\otimes \eta)(\alpha\otimes x))) 
\end{align*}
}


\end{itemize}


It remains to check the Seely isomorphisms.
Using Theorem \ref{theorem:lemay} it suffices to check that the bialgebra modality defined above is additive (with respect to the ``tropical'' additive structure given by $\bot$ and $\vee$).

{\small
\begin{align*}
\nabla((!f\otimes !g)(\Delta(\alpha))) & =
\nabla\left((!f\otimes !g)\left(
\bigvee\{\iota_{n}([x_{1},\dots, x_{n}])\otimes \iota_{m}([y_{1},\dots, y_{m}])\mid [x_{1},\dots, x_{n},y_{1},\dots y_{m}]\leq \alpha(n+m)\}
\right)\right)\\
&=
\nabla\left(
\bigvee\{\iota_{n}([f(x_{1}),\dots, f(x_{n})])\otimes \iota_{m}([g(y_{1}),\dots, g(y_{m})])\mid [x_{1},\dots, x_{n},y_{1},\dots y_{m}]\leq \alpha(n+m)\}
\right)\\
&=
\bigvee\{\iota_{n+m}([f(x_{1}),\dots, f(x_{n}),g(y_{1}),\dots, g(y_{m})])\mid [x_{1},\dots, x_{n},y_{1},\dots y_{m}]\leq \alpha(n+m)\}\\
&=
\bigvee_{n}\{ \iota_{n}([f(x_{1})\vee g(x_{1}),\dots, f(x_{n})\vee g(x_{1})]
\mid [x_{1},\dots, x_{n}]\leq \alpha(n)\}\\
&=
!(f\vee g)(\alpha)
\end{align*}
}
\begin{align*}
u(e(\alpha)) = u(\alpha(0))& =\iota_{0}(\alpha({0})) =
\iota_{0}(\alpha(0))\vee
\bigvee\{\iota_{n+1}([\underbrace{\bot,\dots, \bot}_{n+1}])\mid n\in \BB N \}=
(!\bot) (\alpha)
\end{align*}

In particular, any $\alpha\in !(X\times Y)$ can be represented 
as an object $\alpha^{S}$ of $!X\otimes !Y$ defined as follows:
$$
\alpha^{S}=\bigvee \{ \iota_{n}([x_{1},\dots, x_{n}])\otimes \iota_{m}([y_{1},\dots, y_{m}]) \mid
\iota_{n+m}(\langle x_{1},\bot\rangle,\dots, 
\langle x_{n},\bot\rangle,
\langle \bot, y_{1}\rangle, \dots,
\langle \bot, y_{m}\rangle) \leq \alpha(n+m)
\}
$$


\begin{theorem}
$\Mod$ (equivalently, $\GMet$) is a linear differential category. Hence $\Mod_{!}$ (equivalently, $\GMet_{!}$) is a cartesian closed differential category. 
\end{theorem}
%
%Let us compute the differential operator in $\Mod_{!}$: 
%given $f:!X \to Y$, we have
%\begin{align*}
%E[f](\alpha) & = 
%\bigvee 
%\left \{
%f(\beta\cup[x])
%\ \Big \vert \ 
%\iota_{n}(\beta)\otimes \iota_{1}(x) \leq \alpha^{S}
%\right\}
%\end{align*}

%\begin{definition}
%A coalgebra modality $(!,\delta,\epsilon,\Delta,e)$ is a \emph{monoidal coalgebra modality} if there exist natural transformations $m_{\otimes}:!X\otimes !Y \to !(X\otimes Y)$ 
%and $m_{1}: \{\star\} \to !\{\star\}$ such that 
%\begin{itemize}
%\item $m_{\otimes},m_{k}$ show $(!,\delta,\epsilon)$ as a symmetric monoidal comonad, that is, the following equations hold:
%
%
%\item the following further equations hold:
%\begin{align}
%\Delta \circ m_{\otimes} & = (m_{\otimes}\otimes m_{\otimes})\circ (1\otimes \sigma \otimes 1) \circ (\Delta \otimes \Delta) \\
%
%
%\end{align}
%
%\end{itemize}
%
%\end{definition}

%
%the morphism $\chi= (!\pi_{0}\otimes !\pi_{1})\circ \Delta$ is given by 
%%\begin{align*}
%%\chi(\alpha)&=(!\pi_{0}\otimes !\pi_{1})\left(
%\bigvee\{
%\iota_{n}(a)\otimes \iota_{m}(b) \mid
%a\cup b \leq \alpha(n+m)
%\}\right)\\
%&=
%\bigvee\{
%\iota_{n}(a)\otimes \iota_{m}(b) \mid
%a\cup b \leq \alpha(n+m)
%\}\right)\\
%\end{align*}



%$m_{\otimes}(\alpha\otimes \beta)(n)= \alpha(n)\otimes \beta(n)$
%
%
%
%$m_{Q}(\epsilon)=\iota_{1}(\epsilon)$.
%
%
%




